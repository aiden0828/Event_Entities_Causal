{"tokens": ["An", "unpatched", "vulnerability", "in", "the", "Magento", "e-commerce", "platform", "could", "allow", "hackers", "to", "upload", "and", "execute", "malicious", "code", "on", "web", "servers", "that", "host", "online", "shops", ".", "The", "flaw", "was", "discovered", "by", "researchers", "from", "security", "consultancy", "DefenseCode", "and", "is", "located", "in", "a", "feature", "that", "retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo", ".", "Such", "videos", "can", "be", "added", "to", "product", "listings", "in", "Magento", ".", "The", "DefenseCode", "researchers", "determined", "that", "if", "the", "image", "URL", "points", "to", "a", "different", "file", ",", "for", "example", "a", "PHP", "script", ",", "Magento", "will", "download", "the", "file", "in", "order", "to", "validate", "it", ".", "If", "the", "file", "is", "not", "an", "image", ",", "the", "platform", "will", "return", "a", "\"", "Disallowed", "file", "type", "\"", "error", ",", "but", "wo", "n't", "actually", "remove", "it", "from", "the", "server", ".", "An", "attacker", "with", "access", "to", "exploit", "this", "flaw", "could", "achieve", "remote", "code", "execution", "by", "first", "tricking", "Magento", "to", "download", "an", ".", "htaccess", "configuration", "file", "that", "enables", "PHP", "execution", "inside", "the", "download", "directory", "and", "then", "downloading", "the", "malicious", "PHP", "file", "itself", ".", "Once", "on", "the", "server", ",", "the", "PHP", "script", "can", "act", "as", "a", "backdoor", "and", "can", "be", "accessed", "from", "an", "external", "location", "by", "pointing", "the", "browser", "to", "it", ".", "For", "example", ",", "attackers", "could", "use", "it", "to", "browse", "the", "server", "directories", "and", "read", "the", "database", "password", "from", "Magento", "'s", "configuration", "file", ".", "This", "can", "expose", "customer", "information", "stored", "in", "the", "database", ",", "which", "in", "the", "case", "of", "online", "shops", ",", "can", "be", "very", "sensitive", ".", "The", "only", "limitation", "is", "that", "this", "vulnerability", "can", "not", "be", "exploited", "directly", "because", "the", "video", "-", "linking", "functionality", "requires", "authentication", ".", "This", "means", "attackers", "need", "to", "have", "access", "to", "an", "account", "on", "the", "targeted", "website", ",", "but", "this", "can", "be", "a", "lower", "-", "privileged", "user", "and", "not", "necessarily", "an", "administrator", ".", "The", "authentication", "obstacle", "can", "also", "be", "easily", "overcome", "if", "the", "website", "does", "n't", "have", "the", "\"", "Add", "Secret", "Key", "to", "URLs", "\"", "option", "turned", "on", ".", "This", "option", "is", "intended", "to", "prevent", "cross-site", "request", "forgery", "(", "CSRF", ")", "attacks", "and", "is", "enabled", "by", "default", ".", "CSRF", "is", "an", "attack", "technique", "that", "involves", "forcing", "a", "user", "\u2019s", "browser", "to", "perform", "an", "unauthorized", "request", "on", "a", "website", "when", "visiting", "a", "different", "one", ".", "\"", "The", "attack", "can", "be", "constructed", "as", "simple", "as", "<", "img", "src", "=", "\u2026", "in", "an", "email", "or", "a", "public", "message", "board", ",", "which", "will", "automatically", "trigger", "the", "arbitrary", "file", "upload", "if", "a", "user", "is", "currently", "logged", "into", "Magento", ",", "\"", "the", "DefenseCode", "researchers", "said", "in", "an", "advisory", ".", "\"", "An", "attacker", "can", "also", "entice", "the", "user", "to", "open", "a", "CSRF", "link", "using", "social", "engineering", ".", "\"", "This", "means", "that", "by", "simply", "clicking", "on", "a", "link", "in", "an", "email", "or", "by", "visiting", "a", "specifically", "crafted", "web", "page", ",", "users", "who", "have", "active", "Magento", "sessions", "in", "their", "browser", "might", "have", "their", "accounts", "abused", "to", "compromise", "websites", ".", "The", "DefenseCode", "researchers", "claim", "that", "they", "'ve", "reported", "these", "issues", "to", "the", "Magento", "developers", "back", "in", "November", ",", "but", "received", "no", "information", "regarding", "patching", "plans", "since", "then", ".", "Several", "versions", "of", "the", "Magento", "Community", "Edition", "(", "CE", ")", "have", "been", "released", "since", "November", ",", "the", "most", "recent", "one", "being", "2.1.6", "on", "Tuesday", ".", "According", "to", "DefenseCode", ",", "all", "Magento", "CE", "versions", "continue", "to", "be", "vulnerable", ",", "which", "is", "what", "prompted", "them", "to", "go", "public", "about", "the", "flaw", ".", "\u201c", "We", "have", "been", "actively", "investigating", "the", "root", "cause", "of", "the", "reported", "issue", "and", "are", "not", "aware", "of", "any", "attacks", "in", "the", "wild", ",", "\u201d", "Magento", ",", "the", "company", "that", "oversees", "development", "of", "the", "e-commerce", "platform", ",", "said", "in", "an", "emailed", "statement", ".", "\u201c", "We", "will", "be", "addressing", "the", "issue", "in", "our", "next", "patch", "release", "and", "continue", "to", "consistently", "work", "to", "improve", "our", "assurance", "processes", ".", "\u201d", "\"", "All", "users", "are", "strongly", "advised", "to", "enforce", "the", "use", "of", "'", "Add", "Secret", "Key", "to", "URLs", "'", "which", "mitigates", "the", "CSRF", "attack", "vector", ",", "\"", "the", "DefenseCode", "researchers", "said", ".", "\"", "To", "prevent", "remote", "code", "execution", "through", "arbitrary", "file", "upload", "the", "server", "should", "be", "configured", "to", "disallow", ".", "htaccess", "files", "in", "affected", "directories", ".", "\"", "Magento", "is", "used", "by", "over", "250,000", "online", "retailers", ",", "making", "it", "an", "attractive", "target", "for", "hackers", ".", "Last", "year", ",", "researchers", "found", "thousands", "of", "Magento", "-", "based", "online", "shops", "that", "had", "been", "compromised", "and", "infected", "with", "malicious", "code", "that", "skimmed", "payment", "card", "details", "."], "entities": [{"type": "Databreach", "start": 698, "end": 701, "text": ["had", "been", "compromised"], "role": "trigger"}, {"type": "System", "start": 692, "end": 697, "text": ["Magento", "-", "based", "online", "shops"], "role": "Victim"}, {"type": "Number", "start": 690, "end": 691, "text": ["thousands"], "role": "Number-of-Victim"}, {"type": "Time", "start": 685, "end": 687, "text": ["Last", "year"], "role": "Time"}, {"type": "Databreach", "start": 707, "end": 708, "text": ["skimmed"], "role": "trigger"}, {"type": "PII", "start": 708, "end": 711, "text": ["payment", "card", "details"], "role": "Compromised-Data"}, {"type": "Capabilities", "start": 702, "end": 706, "text": ["infected", "with", "malicious", "code"], "role": "Attack-Pattern"}, {"type": "DiscoverVulnerability", "start": 36, "end": 39, "text": ["is", "located", "in"], "role": "trigger"}, {"type": "Software", "start": 40, "end": 41, "text": ["feature"], "role": "Vulnerable_System"}, {"type": "Capabilities", "start": 42, "end": 50, "text": ["retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo"], "role": "Capabilities"}, {"type": "DiscoverVulnerability", "start": 27, "end": 29, "text": ["was", "discovered"], "role": "trigger"}, {"type": "Person", "start": 30, "end": 31, "text": ["researchers"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 25, "end": 27, "text": ["The", "flaw"], "role": "Vulnerability"}, {"type": "Organization", "start": 32, "end": 35, "text": ["security", "consultancy", "DefenseCode"], "role": "Discoverer"}, {"type": "DiscoverVulnerability", "start": 248, "end": 250, "text": ["be", "exploited"], "role": "trigger"}, {"type": "Vulnerability", "start": 245, "end": 246, "text": ["vulnerability"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 474, "end": 475, "text": ["reported"], "role": "trigger"}, {"type": "Person", "start": 478, "end": 481, "text": ["the", "Magento", "developers"], "role": "Vulnerable_System_Owner"}, {"type": "Person", "start": 472, "end": 473, "text": ["they"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 475, "end": 477, "text": ["these", "issues"], "role": "Vulnerability"}, {"type": "Time", "start": 483, "end": 484, "text": ["November"], "role": "Time"}, {"type": "DiscoverVulnerability", "start": 470, "end": 471, "text": ["claim"], "role": "trigger"}, {"type": "Person", "start": 467, "end": 470, "text": ["The", "DefenseCode", "researchers"], "role": "Discoverer"}, {"type": "DiscoverVulnerability", "start": 530, "end": 532, "text": ["be", "vulnerable"], "role": "trigger"}, {"type": "Organization", "start": 522, "end": 523, "text": ["DefenseCode"], "role": "Discoverer"}, {"type": "Version", "start": 524, "end": 528, "text": ["all", "Magento", "CE", "versions"], "role": "Vulnerable_System_Version"}, {"type": "DiscoverVulnerability", "start": 539, "end": 541, "text": ["go", "public"], "role": "trigger"}, {"type": "Vulnerability", "start": 542, "end": 544, "text": ["the", "flaw"], "role": "Vulnerability"}, {"type": "PatchVulnerability", "start": 490, "end": 492, "text": ["patching", "plans"], "role": "trigger"}, {"type": "PatchVulnerability", "start": 590, "end": 593, "text": ["will", "be", "addressing"], "role": "trigger"}, {"type": "Vulnerability", "start": 593, "end": 595, "text": ["the", "issue"], "role": "Vulnerability"}, {"type": "Person", "start": 589, "end": 590, "text": ["We"], "role": "Releaser"}, {"type": "Patch", "start": 596, "end": 600, "text": ["our", "next", "patch", "release"], "role": "Patch"}, {"type": "DiscoverVulnerability", "start": 547, "end": 551, "text": ["have", "been", "actively", "investigating"], "role": "trigger"}, {"type": "Vulnerability", "start": 555, "end": 558, "text": ["the", "reported", "issue"], "role": "Vulnerability"}, {"type": "Organization", "start": 546, "end": 547, "text": ["We"], "role": "Vulnerable_System_Owner"}], "relations": [{"type": "Effect", "head": 0, "tail": 1}, {"type": "Effect", "head": 4, "tail": 5}, {"type": "Causal", "head": 6, "tail": 4}, {"type": "Causal", "head": 9, "tail": 7}, {"type": "Causal", "head": 11, "tail": 10}, {"type": "Causal", "head": 12, "tail": 10}, {"type": "Causal", "head": 13, "tail": 10}, {"type": "Causal", "head": 15, "tail": 14}, {"type": "Causal", "head": 18, "tail": 16}, {"type": "Causal", "head": 19, "tail": 16}, {"type": "Causal", "head": 22, "tail": 21}, {"type": "Causal", "head": 24, "tail": 23}, {"type": "Causal", "head": 27, "tail": 26}, {"type": "Causal", "head": 30, "tail": 29}, {"type": "Causal", "head": 31, "tail": 29}, {"type": "Causal", "head": 34, "tail": 33}], "POS": ["DT", "JJ", "NN", "IN", "DT", "NNP", "NN", "NN", "MD", "VB", "NNS", "TO", "VB", "CC", "VB", "JJ", "NN", "IN", "NN", "NNS", "WDT", "VBP", "JJ", "NNS", ".", "DT", "NN", "VBD", "VBN", "IN", "NNS", "IN", "NN", "NN", "NNP", "CC", "VBZ", "VBN", "IN", "DT", "NN", "WDT", "VBZ", "NN", "NNS", "IN", "NNS", "VBN", "IN", "NNP", ".", "JJ", "NNS", "MD", "VB", "VBN", "TO", "NN", "NNS", "IN", "NNP", ".", "DT", "NNP", "NNS", "VBD", "IN", "IN", "DT", "NN", "NNP", "NNS", "TO", "DT", "JJ", "NN", ",", "IN", "NN", "DT", "NNP", "NN", ",", "NNP", "MD", "VB", "DT", "NN", "IN", "NN", "TO", "VB", "PRP", ".", "IN", "DT", "NN", "VBZ", "RB", "DT", "NN", ",", "DT", "NN", "MD", "VB", "DT", "NN", "NNP", "NN", "NN", "NNP", "NN", ",", "CC", "MD", "RB", "RB", "VB", "PRP", "IN", "DT", "NN", ".", "DT", "NN", "IN", "NN", "TO", "VB", "DT", "NN", "MD", "VB", "JJ", "NN", "NN", "IN", "JJ", "VBG", "NNP", "TO", "VB", "DT", ".", "NN", "NN", "NN", "WDT", "VBZ", "NNP", "NN", "IN", "DT", "NN", "NN", "CC", "RB", "VBG", "DT", "JJ", "NNP", "NN", "PRP", ".", "RB", "IN", "DT", "NN", ",", "DT", "NNP", "NN", "MD", "VB", "IN", "DT", "NN", "CC", "MD", "VB", "VBN", "IN", "DT", "JJ", "NN", "IN", "VBG", "DT", "NN", "TO", "PRP", ".", "IN", "NN", ",", "NNS", "MD", "VB", "PRP", "TO", "VB", "DT", "NN", "NNS", "CC", "VB", "DT", "NN", "NN", "IN", "NNP", "POS", "NN", "NN", ".", "DT", "MD", "VB", "NN", "NN", "VBN", "IN", "DT", "NN", ",", "WDT", "IN", "DT", "NN", "IN", "NN", "NNS", ",", "MD", "VB", "RB", "JJ", ".", "DT", "JJ", "NN", "VBZ", "IN", "DT", "NN", "MD", "RB", "VB", "VBN", "RB", "IN", "DT", "NN", ":", "VBG", "NN", "VBZ", "NN", ".", "DT", "VBZ", "NNS", "VBP", "TO", "VB", "NN", "TO", "DT", "NN", "IN", "DT", "JJ", "NN", ",", "CC", "DT", "MD", "VB", "DT", "JJR", ":", "VBN", "NN", "CC", "RB", "RB", "DT", "NN", ".", "DT", "NN", "NN", "MD", "RB", "VB", "RB", "VB", "IN", "DT", "NN", "VBZ", "RB", "VB", "DT", "NNP", "NNP", "NNP", "NNP", "TO", "NNP", "NNP", "NN", "VBD", "IN", ".", "DT", "NN", "VBZ", "VBN", "TO", "VB", "JJ", "NN", "NN", "(", "NNP", ")", "NNS", "CC", "VBZ", "VBN", "IN", "NN", ".", "NNP", "VBZ", "DT", "NN", "NN", "WDT", "VBZ", "VBG", "DT", "NN", "NNP", "NN", "TO", "VB", "DT", "JJ", "NN", "IN", "DT", "NN", "WRB", "VBG", "DT", "JJ", "NN", ".", "VB", "DT", "NN", "MD", "VB", "VBN", "RB", "JJ", "IN", "JJ", "NN", "NN", "NNP", "NNP", "IN", "DT", "NN", "CC", "DT", "JJ", "NN", "NN", ",", "WDT", "MD", "RB", "VB", "DT", "JJ", "NN", "NN", "IN", "DT", "NN", "VBZ", "RB", "VBN", "IN", "NNP", ",", "VBZ", "DT", "NNP", "NNS", "VBD", "IN", "DT", "JJ", ".", "VB", "DT", "NN", "MD", "RB", "VB", "DT", "NN", "TO", "VB", "DT", "NNP", "NN", "VBG", "JJ", "NN", ".", "VB", "DT", "VBZ", "IN", "IN", "RB", "VBG", "IN", "DT", "NN", "IN", "DT", "NN", "CC", "IN", "VBG", "DT", "RB", "VBN", "NN", "NN", ",", "NNS", "WP", "VBP", "JJ", "NNP", "NNS", "IN", "PRP$", "NN", "MD", "VB", "PRP$", "NNS", "VBN", "TO", "VB", "NNS", ".", "DT", "NNP", "NNS", "VBP", "IN", "PRP", "VBP", "VBN", "DT", "NNS", "TO", "DT", "NNP", "NNS", "RB", "IN", "NNP", ",", "CC", "VBD", "DT", "NN", "VBG", "NN", "NNS", "IN", "RB", ".", "JJ", "NNS", "IN", "DT", "NNP", "NNP", "NNP", "(", "NNP", ")", "VBP", "VBN", "VBN", "IN", "NNP", ",", "DT", "RBS", "JJ", "CD", "VBG", "CD", "IN", "NNP", ".", "VBG", "TO", "NNP", ",", "DT", "NNP", "NNP", "NNS", "VBP", "TO", "VB", "JJ", ",", "WDT", "VBZ", "WP", "VBD", "PRP", "TO", "VB", "JJ", "IN", "DT", "NN", ".", "NN", "PRP", "VBP", "VBN", "RB", "VBG", "DT", "NN", "NN", "IN", "DT", "VBN", "NN", "CC", "VBP", "RB", "JJ", "IN", "DT", "NNS", "IN", "DT", "JJ", ",", "NNP", "NNP", ",", "DT", "NN", "WDT", "VBZ", "NN", "IN", "DT", "JJ", "NN", ",", "VBD", "IN", "DT", "JJ", "NN", ".", "NN", "PRP", "MD", "VB", "VBG", "DT", "NN", "IN", "PRP$", "JJ", "NN", "NN", "CC", "VB", "TO", "RB", "VB", "TO", "VB", "PRP$", "NN", "VBZ", ".", "VB", "IN", "DT", "NNS", "VBP", "RB", "VBN", "TO", "VB", "DT", "NN", "IN", "''", "NNP", "NNP", "NNP", "TO", "NNP", "POS", "WDT", "VBZ", "DT", "NNP", "NN", "NN", ",", "VBP", "DT", "NNP", "NNS", "VBD", ".", "NN", "TO", "VB", "JJ", "NN", "NN", "IN", "JJ", "NN", "IN", "DT", "NN", "MD", "VB", "VBN", "TO", "VB", ".", "NN", "NNS", "IN", "JJ", "NNS", ".", "VB", "NNP", "VBZ", "VBN", "IN", "IN", "CD", "JJ", "NNS", ",", "VBG", "PRP", "DT", "JJ", "NN", "IN", "NNS", ".", "JJ", "NN", ",", "NNS", "VBD", "NNS", "IN", "NNP", ":", "VBN", "JJ", "NNS", "WDT", "VBD", "VBN", "VBN", "CC", "VBN", "IN", "JJ", "NN", "WDT", "VBD", "NN", "NN", "NNS", "."]}