{"tokens": ["An", "unpatched", "vulnerability", "in", "the", "Magento", "e-commerce", "platform", "could", "allow", "hackers", "to", "upload", "and", "execute", "malicious", "code", "on", "web", "servers", "that", "host", "online", "shops", ".", "The", "flaw", "was", "discovered", "by", "researchers", "from", "security", "consultancy", "DefenseCode", "and", "is", "located", "in", "a", "feature", "that", "retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo", ".", "Such", "videos", "can", "be", "added", "to", "product", "listings", "in", "Magento", ".", "The", "DefenseCode", "researchers", "determined", "that", "if", "the", "image", "URL", "points", "to", "a", "different", "file", ",", "for", "example", "a", "PHP", "script", ",", "Magento", "will", "download", "the", "file", "in", "order", "to", "validate", "it", ".", "If", "the", "file", "is", "not", "an", "image", ",", "the", "platform", "will", "return", "a", "\"", "Disallowed", "file", "type", "\"", "error", ",", "but", "wo", "n't", "actually", "remove", "it", "from", "the", "server", ".", "An", "attacker", "with", "access", "to", "exploit", "this", "flaw", "could", "achieve", "remote", "code", "execution", "by", "first", "tricking", "Magento", "to", "download", "an", ".", "htaccess", "configuration", "file", "that", "enables", "PHP", "execution", "inside", "the", "download", "directory", "and", "then", "downloading", "the", "malicious", "PHP", "file", "itself", ".", "Once", "on", "the", "server", ",", "the", "PHP", "script", "can", "act", "as", "a", "backdoor", "and", "can", "be", "accessed", "from", "an", "external", "location", "by", "pointing", "the", "browser", "to", "it", ".", "For", "example", ",", "attackers", "could", "use", "it", "to", "browse", "the", "server", "directories", "and", "read", "the", "database", "password", "from", "Magento", "'s", "configuration", "file", ".", "This", "can", "expose", "customer", "information", "stored", "in", "the", "database", ",", "which", "in", "the", "case", "of", "online", "shops", ",", "can", "be", "very", "sensitive", ".", "The", "only", "limitation", "is", "that", "this", "vulnerability", "can", "not", "be", "exploited", "directly", "because", "the", "video", "-", "linking", "functionality", "requires", "authentication", ".", "This", "means", "attackers", "need", "to", "have", "access", "to", "an", "account", "on", "the", "targeted", "website", ",", "but", "this", "can", "be", "a", "lower", "-", "privileged", "user", "and", "not", "necessarily", "an", "administrator", ".", "The", "authentication", "obstacle", "can", "also", "be", "easily", "overcome", "if", "the", "website", "does", "n't", "have", "the", "\"", "Add", "Secret", "Key", "to", "URLs", "\"", "option", "turned", "on", ".", "This", "option", "is", "intended", "to", "prevent", "cross-site", "request", "forgery", "(", "CSRF", ")", "attacks", "and", "is", "enabled", "by", "default", ".", "CSRF", "is", "an", "attack", "technique", "that", "involves", "forcing", "a", "user", "\u2019s", "browser", "to", "perform", "an", "unauthorized", "request", "on", "a", "website", "when", "visiting", "a", "different", "one", ".", "\"", "The", "attack", "can", "be", "constructed", "as", "simple", "as", "<", "img", "src", "=", "\u2026", "in", "an", "email", "or", "a", "public", "message", "board", ",", "which", "will", "automatically", "trigger", "the", "arbitrary", "file", "upload", "if", "a", "user", "is", "currently", "logged", "into", "Magento", ",", "\"", "the", "DefenseCode", "researchers", "said", "in", "an", "advisory", ".", "\"", "An", "attacker", "can", "also", "entice", "the", "user", "to", "open", "a", "CSRF", "link", "using", "social", "engineering", ".", "\"", "This", "means", "that", "by", "simply", "clicking", "on", "a", "link", "in", "an", "email", "or", "by", "visiting", "a", "specifically", "crafted", "web", "page", ",", "users", "who", "have", "active", "Magento", "sessions", "in", "their", "browser", "might", "have", "their", "accounts", "abused", "to", "compromise", "websites", ".", "The", "DefenseCode", "researchers", "claim", "that", "they", "'ve", "reported", "these", "issues", "to", "the", "Magento", "developers", "back", "in", "November", ",", "but", "received", "no", "information", "regarding", "patching", "plans", "since", "then", ".", "Several", "versions", "of", "the", "Magento", "Community", "Edition", "(", "CE", ")", "have", "been", "released", "since", "November", ",", "the", "most", "recent", "one", "being", "2.1.6", "on", "Tuesday", ".", "According", "to", "DefenseCode", ",", "all", "Magento", "CE", "versions", "continue", "to", "be", "vulnerable", ",", "which", "is", "what", "prompted", "them", "to", "go", "public", "about", "the", "flaw", ".", "\u201c", "We", "have", "been", "actively", "investigating", "the", "root", "cause", "of", "the", "reported", "issue", "and", "are", "not", "aware", "of", "any", "attacks", "in", "the", "wild", ",", "\u201d", "Magento", ",", "the", "company", "that", "oversees", "development", "of", "the", "e-commerce", "platform", ",", "said", "in", "an", "emailed", "statement", ".", "\u201c", "We", "will", "be", "addressing", "the", "issue", "in", "our", "next", "patch", "release", "and", "continue", "to", "consistently", "work", "to", "improve", "our", "assurance", "processes", ".", "\u201d", "\"", "All", "users", "are", "strongly", "advised", "to", "enforce", "the", "use", "of", "'", "Add", "Secret", "Key", "to", "URLs", "'", "which", "mitigates", "the", "CSRF", "attack", "vector", ",", "\"", "the", "DefenseCode", "researchers", "said", ".", "\"", "To", "prevent", "remote", "code", "execution", "through", "arbitrary", "file", "upload", "the", "server", "should", "be", "configured", "to", "disallow", ".", "htaccess", "files", "in", "affected", "directories", ".", "\"", "Magento", "is", "used", "by", "over", "250,000", "online", "retailers", ",", "making", "it", "an", "attractive", "target", "for", "hackers", ".", "Last", "year", ",", "researchers", "found", "thousands", "of", "Magento", "-", "based", "online", "shops", "that", "had", "been", "compromised", "and", "infected", "with", "malicious", "code", "that", "skimmed", "payment", "card", "details", "."], "Event 1": {"trigger": {"start": 698, "end": 701, "text": ["had", "been", "compromised"]}, "event_type": "Databreach", "argument": [{"start": 692, "end": 697, "text": ["Magento", "-", "based", "online", "shops"]}, {"start": 690, "end": 691, "text": ["thousands"]}, {"start": 685, "end": 687, "text": ["Last", "year"]}], "Causal": [], "Effect": [{"start": 692, "end": 697, "text": ["Magento", "-", "based", "online", "shops"]}]}, "Event 2": {"trigger": {"start": 707, "end": 708, "text": ["skimmed"]}, "event_type": "Databreach", "argument": [{"start": 708, "end": 711, "text": ["payment", "card", "details"]}, {"start": 702, "end": 706, "text": ["infected", "with", "malicious", "code"]}], "Causal": [{"start": 702, "end": 706, "text": ["infected", "with", "malicious", "code"]}], "Effect": [{"start": 708, "end": 711, "text": ["payment", "card", "details"]}]}, "Event 3": {"trigger": {"start": 36, "end": 39, "text": ["is", "located", "in"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 40, "end": 41, "text": ["feature"]}, {"start": 42, "end": 50, "text": ["retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo"]}], "Causal": [{"start": 42, "end": 50, "text": ["retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo"]}], "Effect": []}, "Event 4": {"trigger": {"start": 27, "end": 29, "text": ["was", "discovered"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 30, "end": 31, "text": ["researchers"]}, {"start": 25, "end": 27, "text": ["The", "flaw"]}, {"start": 32, "end": 35, "text": ["security", "consultancy", "DefenseCode"]}], "Causal": [{"start": 30, "end": 31, "text": ["researchers"]}, {"start": 25, "end": 27, "text": ["The", "flaw"]}, {"start": 32, "end": 35, "text": ["security", "consultancy", "DefenseCode"]}], "Effect": []}, "Event 5": {"trigger": {"start": 248, "end": 250, "text": ["be", "exploited"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 245, "end": 246, "text": ["vulnerability"]}], "Causal": [{"start": 245, "end": 246, "text": ["vulnerability"]}], "Effect": []}, "Event 6": {"trigger": {"start": 474, "end": 475, "text": ["reported"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 478, "end": 481, "text": ["the", "Magento", "developers"]}, {"start": 472, "end": 473, "text": ["they"]}, {"start": 475, "end": 477, "text": ["these", "issues"]}, {"start": 483, "end": 484, "text": ["November"]}], "Causal": [{"start": 472, "end": 473, "text": ["they"]}, {"start": 475, "end": 477, "text": ["these", "issues"]}], "Effect": []}, "Event 7": {"trigger": {"start": 470, "end": 471, "text": ["claim"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 467, "end": 470, "text": ["The", "DefenseCode", "researchers"]}], "Causal": [{"start": 467, "end": 470, "text": ["The", "DefenseCode", "researchers"]}], "Effect": []}, "Event 8": {"trigger": {"start": 530, "end": 532, "text": ["be", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 522, "end": 523, "text": ["DefenseCode"]}, {"start": 524, "end": 528, "text": ["all", "Magento", "CE", "versions"]}], "Causal": [{"start": 522, "end": 523, "text": ["DefenseCode"]}], "Effect": []}, "Event 9": {"trigger": {"start": 539, "end": 541, "text": ["go", "public"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 542, "end": 544, "text": ["the", "flaw"]}], "Causal": [{"start": 542, "end": 544, "text": ["the", "flaw"]}], "Effect": []}, "Event 10": {"trigger": {"start": 490, "end": 492, "text": ["patching", "plans"]}, "event_type": "PatchVulnerability", "argument": [], "Causal": [], "Effect": []}, "Event 11": {"trigger": {"start": 590, "end": 593, "text": ["will", "be", "addressing"]}, "event_type": "PatchVulnerability", "argument": [{"start": 593, "end": 595, "text": ["the", "issue"]}, {"start": 589, "end": 590, "text": ["We"]}, {"start": 596, "end": 600, "text": ["our", "next", "patch", "release"]}], "Causal": [{"start": 593, "end": 595, "text": ["the", "issue"]}, {"start": 589, "end": 590, "text": ["We"]}], "Effect": []}, "Event 12": {"trigger": {"start": 547, "end": 551, "text": ["have", "been", "actively", "investigating"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 555, "end": 558, "text": ["the", "reported", "issue"]}, {"start": 546, "end": 547, "text": ["We"]}], "Causal": [{"start": 555, "end": 558, "text": ["the", "reported", "issue"]}], "Effect": []}}