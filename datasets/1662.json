{"tokens": ["An", "unpatched", "vulnerability", "in", "the", "Magento", "e-commerce", "platform", "could", "allow", "hackers", "to", "upload", "and", "execute", "malicious", "code", "on", "web", "servers", "that", "host", "online", "shops", ".", "The", "flaw", "was", "discovered", "by", "researchers", "from", "security", "consultancy", "DefenseCode", "and", "is", "located", "in", "a", "feature", "that", "retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo", ".", "Such", "videos", "can", "be", "added", "to", "product", "listings", "in", "Magento", ".", "The", "DefenseCode", "researchers", "determined", "that", "if", "the", "image", "URL", "points", "to", "a", "different", "file", ",", "for", "example", "a", "PHP", "script", ",", "Magento", "will", "download", "the", "file", "in", "order", "to", "validate", "it", ".", "If", "the", "file", "is", "not", "an", "image", ",", "the", "platform", "will", "return", "a", "\"", "Disallowed", "file", "type", "\"", "error", ",", "but", "wo", "n't", "actually", "remove", "it", "from", "the", "server", ".", "An", "attacker", "with", "access", "to", "exploit", "this", "flaw", "could", "achieve", "remote", "code", "execution", "by", "first", "tricking", "Magento", "to", "download", "an", ".", "htaccess", "configuration", "file", "that", "enables", "PHP", "execution", "inside", "the", "download", "directory", "and", "then", "downloading", "the", "malicious", "PHP", "file", "itself", ".", "Once", "on", "the", "server", ",", "the", "PHP", "script", "can", "act", "as", "a", "backdoor", "and", "can", "be", "accessed", "from", "an", "external", "location", "by", "pointing", "the", "browser", "to", "it", ".", "For", "example", ",", "attackers", "could", "use", "it", "to", "browse", "the", "server", "directories", "and", "read", "the", "database", "password", "from", "Magento", "'s", "configuration", "file", ".", "This", "can", "expose", "customer", "information", "stored", "in", "the", "database", ",", "which", "in", "the", "case", "of", "online", "shops", ",", "can", "be", "very", "sensitive", ".", "The", "only", "limitation", "is", "that", "this", "vulnerability", "can", "not", "be", "exploited", "directly", "because", "the", "video", "-", "linking", "functionality", "requires", "authentication", ".", "This", "means", "attackers", "need", "to", "have", "access", "to", "an", "account", "on", "the", "targeted", "website", ",", "but", "this", "can", "be", "a", "lower", "-", "privileged", "user", "and", "not", "necessarily", "an", "administrator", ".", "The", "authentication", "obstacle", "can", "also", "be", "easily", "overcome", "if", "the", "website", "does", "n't", "have", "the", "\"", "Add", "Secret", "Key", "to", "URLs", "\"", "option", "turned", "on", ".", "This", "option", "is", "intended", "to", "prevent", "cross-site", "request", "forgery", "(", "CSRF", ")", "attacks", "and", "is", "enabled", "by", "default", ".", "CSRF", "is", "an", "attack", "technique", "that", "involves", "forcing", "a", "user", "\u2019s", "browser", "to", "perform", "an", "unauthorized", "request", "on", "a", "website", "when", "visiting", "a", "different", "one", ".", "\"", "The", "attack", "can", "be", "constructed", "as", "simple", "as", "<", "img", "src", "=", "\u2026", "in", "an", "email", "or", "a", "public", "message", "board", ",", "which", "will", "automatically", "trigger", "the", "arbitrary", "file", "upload", "if", "a", "user", "is", "currently", "logged", "into", "Magento", ",", "\"", "the", "DefenseCode", "researchers", "said", "in", "an", "advisory", ".", "\"", "An", "attacker", "can", "also", "entice", "the", "user", "to", "open", "a", "CSRF", "link", "using", "social", "engineering", ".", "\"", "This", "means", "that", "by", "simply", "clicking", "on", "a", "link", "in", "an", "email", "or", "by", "visiting", "a", "specifically", "crafted", "web", "page", ",", "users", "who", "have", "active", "Magento", "sessions", "in", "their", "browser", "might", "have", "their", "accounts", "abused", "to", "compromise", "websites", ".", "The", "DefenseCode", "researchers", "claim", "that", "they", "'ve", "reported", "these", "issues", "to", "the", "Magento", "developers", "back", "in", "November", ",", "but", "received", "no", "information", "regarding", "patching", "plans", "since", "then", ".", "Several", "versions", "of", "the", "Magento", "Community", "Edition", "(", "CE", ")", "have", "been", "released", "since", "November", ",", "the", "most", "recent", "one", "being", "2.1.6", "on", "Tuesday", ".", "According", "to", "DefenseCode", ",", "all", "Magento", "CE", "versions", "continue", "to", "be", "vulnerable", ",", "which", "is", "what", "prompted", "them", "to", "go", "public", "about", "the", "flaw", ".", "\u201c", "We", "have", "been", "actively", "investigating", "the", "root", "cause", "of", "the", "reported", "issue", "and", "are", "not", "aware", "of", "any", "attacks", "in", "the", "wild", ",", "\u201d", "Magento", ",", "the", "company", "that", "oversees", "development", "of", "the", "e-commerce", "platform", ",", "said", "in", "an", "emailed", "statement", ".", "\u201c", "We", "will", "be", "addressing", "the", "issue", "in", "our", "next", "patch", "release", "and", "continue", "to", "consistently", "work", "to", "improve", "our", "assurance", "processes", ".", "\u201d", "\"", "All", "users", "are", "strongly", "advised", "to", "enforce", "the", "use", "of", "'", "Add", "Secret", "Key", "to", "URLs", "'", "which", "mitigates", "the", "CSRF", "attack", "vector", ",", "\"", "the", "DefenseCode", "researchers", "said", ".", "\"", "To", "prevent", "remote", "code", "execution", "through", "arbitrary", "file", "upload", "the", "server", "should", "be", "configured", "to", "disallow", ".", "htaccess", "files", "in", "affected", "directories", ".", "\"", "Magento", "is", "used", "by", "over", "250,000", "online", "retailers", ",", "making", "it", "an", "attractive", "target", "for", "hackers", ".", "Last", "year", ",", "researchers", "found", "thousands", "of", "Magento", "-", "based", "online", "shops", "that", "had", "been", "compromised", "and", "infected", "with", "malicious", "code", "that", "skimmed", "payment", "card", "details", "."], "trigger": [{"start": 698, "end": 700, "text": ["had", "been", "compromised"], "event": "Databreach"}, {"start": 707, "end": 707, "text": ["skimmed"], "event": "Databreach"}, {"start": 36, "end": 38, "text": ["is", "located", "in"], "event": "DiscoverVulnerability"}, {"start": 27, "end": 28, "text": ["was", "discovered"], "event": "DiscoverVulnerability"}, {"start": 248, "end": 249, "text": ["be", "exploited"], "event": "DiscoverVulnerability"}, {"start": 474, "end": 474, "text": ["reported"], "event": "DiscoverVulnerability"}, {"start": 470, "end": 470, "text": ["claim"], "event": "DiscoverVulnerability"}, {"start": 530, "end": 531, "text": ["be", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 539, "end": 540, "text": ["go", "public"], "event": "DiscoverVulnerability"}, {"start": 490, "end": 491, "text": ["patching", "plans"], "event": "PatchVulnerability"}, {"start": 590, "end": 592, "text": ["will", "be", "addressing"], "event": "PatchVulnerability"}, {"start": 547, "end": 550, "text": ["have", "been", "actively", "investigating"], "event": "DiscoverVulnerability"}], "Entities": [[{"start": 692, "end": 696, "text": ["Magento", "-", "based", "online", "shops"], "type": "System"}, {"start": 690, "end": 690, "text": ["thousands"], "type": "Number"}, {"start": 685, "end": 686, "text": ["Last", "year"], "type": "Time"}], [{"start": 708, "end": 710, "text": ["payment", "card", "details"], "type": "PII"}, {"start": 702, "end": 705, "text": ["infected", "with", "malicious", "code"], "type": "Capabilities"}], [{"start": 40, "end": 40, "text": ["feature"], "type": "Software"}, {"start": 42, "end": 49, "text": ["retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo"], "type": "Capabilities"}], [{"start": 30, "end": 30, "text": ["researchers"], "type": "Person"}, {"start": 25, "end": 26, "text": ["The", "flaw"], "type": "Vulnerability"}, {"start": 32, "end": 34, "text": ["security", "consultancy", "DefenseCode"], "type": "Organization"}], [{"start": 245, "end": 245, "text": ["vulnerability"], "type": "Vulnerability"}], [{"start": 478, "end": 480, "text": ["the", "Magento", "developers"], "type": "Person"}, {"start": 472, "end": 472, "text": ["they"], "type": "Person"}, {"start": 475, "end": 476, "text": ["these", "issues"], "type": "Vulnerability"}, {"start": 483, "end": 483, "text": ["November"], "type": "Time"}], [{"start": 467, "end": 469, "text": ["The", "DefenseCode", "researchers"], "type": "Person"}], [{"start": 522, "end": 522, "text": ["DefenseCode"], "type": "Organization"}, {"start": 524, "end": 527, "text": ["all", "Magento", "CE", "versions"], "type": "Version"}], [{"start": 542, "end": 543, "text": ["the", "flaw"], "type": "Vulnerability"}], [], [{"start": 593, "end": 594, "text": ["the", "issue"], "type": "Vulnerability"}, {"start": 589, "end": 589, "text": ["We"], "type": "Person"}, {"start": 596, "end": 599, "text": ["our", "next", "patch", "release"], "type": "Patch"}], [{"start": 555, "end": 557, "text": ["the", "reported", "issue"], "type": "Vulnerability"}, {"start": 546, "end": 546, "text": ["We"], "type": "Organization"}]], "Causal": [[], [], [], [{"start": 30, "end": 30, "text": ["researchers"], "type": "Person"}, {"start": 25, "end": 26, "text": ["The", "flaw"], "type": "Vulnerability"}, {"start": 32, "end": 34, "text": ["security", "consultancy", "DefenseCode"], "type": "Organization"}], [{"start": 245, "end": 245, "text": ["vulnerability"], "type": "Vulnerability"}], [{"start": 472, "end": 472, "text": ["they"], "type": "Person"}, {"start": 475, "end": 476, "text": ["these", "issues"], "type": "Vulnerability"}], [{"start": 467, "end": 469, "text": ["The", "DefenseCode", "researchers"], "type": "Person"}], [{"start": 522, "end": 522, "text": ["DefenseCode"], "type": "Organization"}], [{"start": 542, "end": 543, "text": ["the", "flaw"], "type": "Vulnerability"}], [], [{"start": 593, "end": 594, "text": ["the", "issue"], "type": "Vulnerability"}, {"start": 589, "end": 589, "text": ["We"], "type": "Person"}], [{"start": 555, "end": 557, "text": ["the", "reported", "issue"], "type": "Vulnerability"}, {"start": 546, "end": 546, "text": ["We"], "type": "Organization"}]], "Effect": [[{"start": 692, "end": 696, "text": ["Magento", "-", "based", "online", "shops"], "type": "System"}], [{"start": 708, "end": 710, "text": ["payment", "card", "details"], "type": "PII"}, {"start": 702, "end": 705, "text": ["infected", "with", "malicious", "code"], "type": "Capabilities"}], [{"start": 40, "end": 40, "text": ["feature"], "type": "Software"}, {"start": 42, "end": 49, "text": ["retrieves", "preview", "images", "for", "videos", "hosted", "on", "Vimeo"], "type": "Capabilities"}], [], [], [{"start": 478, "end": 480, "text": ["the", "Magento", "developers"], "type": "Person"}], [], [{"start": 524, "end": 527, "text": ["all", "Magento", "CE", "versions"], "type": "Version"}], [], [], [{"start": 596, "end": 599, "text": ["our", "next", "patch", "release"], "type": "Patch"}], []]}