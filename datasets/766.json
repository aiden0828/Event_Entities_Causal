{"tokens": ["Last", "week", "we", "first", "tweeted", "that", "the", "GuardiCore", "Global", "Sensor", "Network", "(", "GGSN", ")", "has", "detected", "a", "wide", "ransomware", "attack", "targeting", "MySQL", "databases", ".", "The", "attacks", "look", "like", "an", "evolution", "of", "the", "MongoDB", "ransomware", "attacks", "first", "reported", "earlier", "this", "year", "by", "Victor", "Gevers", ".", "Similarly", "to", "the", "MongoDB", "attacks", ",", "owners", "are", "instructed", "to", "pay", "a", "0.2", "Bitcoin", "ransom", "(", "approx", ".", "$", "200", ")", "to", "regain", "access", "to", "their", "content", ".", "We", "saw", "two", "very", "similar", "variations", "of", "the", "attack", "using", "two", "bitcoin", "wallets", ".", "In", "this", "post", "we", "will", "describe", "in", "detail", "the", "attack", "flow", "and", "provide", "some", "recommendations", "on", "how", "to", "protect", "your", "databases", "from", "similar", "attacks", "along", "with", "attack", "IoCs", ".", "The", "attacks", "started", "at", "midnight", "at", "00:15", "on", "February", "12", "and", "lasted", "about", "30", "hours", "in", "which", "hundreds", "of", "attacks", "were", "reported", "by", "GGSN", ".", "We", "were", "able", "to", "trace", "all", "the", "attacks", "to", "109.236.88.20", ",", "an", "IP", "address", "hosted", "by", "worldstream.nl", ",", "a", "Netherlands", "-", "based", "web", "hosting", "company", ".", "The", "attacker", "is", "(", "probably", ")", "running", "from", "a", "compromised", "mail", "server", "which", "also", "serves", "as", "HTTP", "(", "s", ")", "and", "FTP", "server", ".", "Worldstream", "was", "notified", "a", "few", "days", "after", "we", "reported", "the", "attack", ".", "The", "attack", "starts", "with", "\u2018", "root", "\u2019", "password", "brute", "-", "forcing", ".", "Once", "logged", "-", "in", ",", "it", "fetches", "a", "list", "of", "the", "existing", "MySQL", "databases", "and", "their", "tables", "and", "creates", "a", "new", "table", "called", "\u2018", "WARNING", "\u2019", "that", "includes", "a", "contact", "email", "address", ",", "a", "bitcoin", "address", "and", "a", "payment", "demand", ".", "In", "one", "variant", "of", "the", "attack", "the", "table", "is", "added", "to", "an", "existing", "database", ";", "in", "other", "cases", "the", "table", "is", "added", "to", "a", "newly", "created", "database", "called", "\u2018", "PLEASE_READ", "\u2019", ".", "The", "attacker", "will", "then", "delete", "the", "databases", "stored", "on", "the", "server", "and", "disconnect", ",", "sometimes", "without", "even", "dumping", "them", "first", ".", "The", "attack", "as", "reported", "by", "GuardiCore", "Centra", "We", "logged", "two", "versions", "of", "the", "ransom", "message", ":", "INSERT", "INTO", "PLEASE_READ", ".", "`", "WARNING", "`", "(", "id", ",", "warning", ",", "Bitcoin_Address", ",", "Email", ")", "VALUES", "(", "\u2018", "1", "\u2032", ",", "\u2019", "Send", "0.2", "BTC", "to", "this", "address", "and", "contact", "this", "email", "with", "your", "ip", "or", "db_name", "of", "your", "server", "to", "recover", "your", "database", "!", "Your", "DB", "is", "Backed", "up", "to", "our", "servers", "!", "\u2019", ",", "\u2018", "1ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY", "\u2019", ",", "\u2018", "backupservice@mail2tor.com", "\u2019", ")", "INSERT", "INTO", "`", "WARNING", "`", "(", "id", ",", "warning", ")", "VALUES", "(", "1", ",", "\u2018", "SEND", "0.2", "BTC", "TO", "THIS", "ADDRESS", "1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9", "AND", "GO", "TO", "THIS", "SITE", "http://sognd75g4isasu2v.onion/", "TO", "RECOVER", "YOUR", "DATABASE", "!", "The", "second", "version", "offers", "the", "owner", "to", "visit", "the", "following", "darknet", "web", "site", "\u2018", "http://sognd75g4isasu2v.onion/", "\u2019", "to", "recover", "the", "lost", "data", ".", "The", "darknet", "web", "site", "referenced", "in", "the", "ransom", "note", ".", "Each", "version", "uses", "a", "different", "bitcoin", "wallet", ",", "1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9", "vs", "1ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY", "and", "based", "on", "Blockchain", "public", "information", "people", "have", "been", "paying", "up", "."], "trigger": [{"start": 51, "end": 54, "text": ["are", "instructed", "to", "pay"], "event": "Ransom"}, {"start": 58, "end": 58, "text": ["ransom"], "event": "Ransom"}, {"start": 48, "end": 48, "text": ["attacks"], "event": "Ransom"}, {"start": 24, "end": 25, "text": ["The", "attacks"], "event": "Ransom"}, {"start": 31, "end": 34, "text": ["the", "MongoDB", "ransomware", "attacks"], "event": "Ransom"}, {"start": 16, "end": 19, "text": ["a", "wide", "ransomware", "attack"], "event": "Ransom"}, {"start": 79, "end": 80, "text": ["the", "attack"], "event": "Ransom"}, {"start": 251, "end": 253, "text": ["a", "payment", "demand"], "event": "Ransom"}], "Entities": [[{"start": 56, "end": 57, "text": ["0.2", "Bitcoin"], "type": "Money"}, {"start": 50, "end": 50, "text": ["owners"], "type": "Person"}, {"start": 47, "end": 47, "text": ["MongoDB"], "type": "System"}], [{"start": 62, "end": 63, "text": ["$", "200"], "type": "Money"}], [], [], [{"start": 37, "end": 39, "text": ["earlier", "this", "year"], "type": "Time"}], [{"start": 21, "end": 22, "text": ["MySQL", "databases"], "type": "System"}], [{"start": 82, "end": 84, "text": ["two", "bitcoin", "wallets"], "type": "PaymentMethod"}], [{"start": 247, "end": 249, "text": ["a", "bitcoin", "address"], "type": "PaymentMethod"}]], "Causal": [[], [], [], [], [], [], [], [{"start": 247, "end": 249, "text": ["a", "bitcoin", "address"], "type": "PaymentMethod"}]], "Effect": [[{"start": 56, "end": 57, "text": ["0.2", "Bitcoin"], "type": "Money"}, {"start": 50, "end": 50, "text": ["owners"], "type": "Person"}], [{"start": 62, "end": 63, "text": ["$", "200"], "type": "Money"}], [], [], [], [{"start": 21, "end": 22, "text": ["MySQL", "databases"], "type": "System"}], [{"start": 82, "end": 84, "text": ["two", "bitcoin", "wallets"], "type": "PaymentMethod"}], []]}