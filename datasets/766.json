{"tokens": ["Last", "week", "we", "first", "tweeted", "that", "the", "GuardiCore", "Global", "Sensor", "Network", "(", "GGSN", ")", "has", "detected", "a", "wide", "ransomware", "attack", "targeting", "MySQL", "databases", ".", "The", "attacks", "look", "like", "an", "evolution", "of", "the", "MongoDB", "ransomware", "attacks", "first", "reported", "earlier", "this", "year", "by", "Victor", "Gevers", ".", "Similarly", "to", "the", "MongoDB", "attacks", ",", "owners", "are", "instructed", "to", "pay", "a", "0.2", "Bitcoin", "ransom", "(", "approx", ".", "$", "200", ")", "to", "regain", "access", "to", "their", "content", ".", "We", "saw", "two", "very", "similar", "variations", "of", "the", "attack", "using", "two", "bitcoin", "wallets", ".", "In", "this", "post", "we", "will", "describe", "in", "detail", "the", "attack", "flow", "and", "provide", "some", "recommendations", "on", "how", "to", "protect", "your", "databases", "from", "similar", "attacks", "along", "with", "attack", "IoCs", ".", "The", "attacks", "started", "at", "midnight", "at", "00:15", "on", "February", "12", "and", "lasted", "about", "30", "hours", "in", "which", "hundreds", "of", "attacks", "were", "reported", "by", "GGSN", ".", "We", "were", "able", "to", "trace", "all", "the", "attacks", "to", "109.236.88.20", ",", "an", "IP", "address", "hosted", "by", "worldstream.nl", ",", "a", "Netherlands", "-", "based", "web", "hosting", "company", ".", "The", "attacker", "is", "(", "probably", ")", "running", "from", "a", "compromised", "mail", "server", "which", "also", "serves", "as", "HTTP", "(", "s", ")", "and", "FTP", "server", ".", "Worldstream", "was", "notified", "a", "few", "days", "after", "we", "reported", "the", "attack", ".", "The", "attack", "starts", "with", "\u2018", "root", "\u2019", "password", "brute", "-", "forcing", ".", "Once", "logged", "-", "in", ",", "it", "fetches", "a", "list", "of", "the", "existing", "MySQL", "databases", "and", "their", "tables", "and", "creates", "a", "new", "table", "called", "\u2018", "WARNING", "\u2019", "that", "includes", "a", "contact", "email", "address", ",", "a", "bitcoin", "address", "and", "a", "payment", "demand", ".", "In", "one", "variant", "of", "the", "attack", "the", "table", "is", "added", "to", "an", "existing", "database", ";", "in", "other", "cases", "the", "table", "is", "added", "to", "a", "newly", "created", "database", "called", "\u2018", "PLEASE_READ", "\u2019", ".", "The", "attacker", "will", "then", "delete", "the", "databases", "stored", "on", "the", "server", "and", "disconnect", ",", "sometimes", "without", "even", "dumping", "them", "first", ".", "The", "attack", "as", "reported", "by", "GuardiCore", "Centra", "We", "logged", "two", "versions", "of", "the", "ransom", "message", ":", "INSERT", "INTO", "PLEASE_READ", ".", "`", "WARNING", "`", "(", "id", ",", "warning", ",", "Bitcoin_Address", ",", "Email", ")", "VALUES", "(", "\u2018", "1", "\u2032", ",", "\u2019", "Send", "0.2", "BTC", "to", "this", "address", "and", "contact", "this", "email", "with", "your", "ip", "or", "db_name", "of", "your", "server", "to", "recover", "your", "database", "!", "Your", "DB", "is", "Backed", "up", "to", "our", "servers", "!", "\u2019", ",", "\u2018", "1ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY", "\u2019", ",", "\u2018", "backupservice@mail2tor.com", "\u2019", ")", "INSERT", "INTO", "`", "WARNING", "`", "(", "id", ",", "warning", ")", "VALUES", "(", "1", ",", "\u2018", "SEND", "0.2", "BTC", "TO", "THIS", "ADDRESS", "1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9", "AND", "GO", "TO", "THIS", "SITE", "http://sognd75g4isasu2v.onion/", "TO", "RECOVER", "YOUR", "DATABASE", "!", "The", "second", "version", "offers", "the", "owner", "to", "visit", "the", "following", "darknet", "web", "site", "\u2018", "http://sognd75g4isasu2v.onion/", "\u2019", "to", "recover", "the", "lost", "data", ".", "The", "darknet", "web", "site", "referenced", "in", "the", "ransom", "note", ".", "Each", "version", "uses", "a", "different", "bitcoin", "wallet", ",", "1Kg9nGFdAoZWmrn1qPMZstam3CXLgcxPA9", "vs", "1ET9NHZEXXQ34qSP46vKg8mrWgT89cfZoY", "and", "based", "on", "Blockchain", "public", "information", "people", "have", "been", "paying", "up", "."], "entities": [{"type": "Ransom", "start": 51, "end": 55, "text": ["are", "instructed", "to", "pay"], "role": "trigger"}, {"type": "Money", "start": 56, "end": 58, "text": ["0.2", "Bitcoin"], "role": "Price"}, {"type": "Person", "start": 50, "end": 51, "text": ["owners"], "role": "Victim"}, {"type": "System", "start": 47, "end": 48, "text": ["MongoDB"], "role": "Victim"}, {"type": "Ransom", "start": 58, "end": 59, "text": ["ransom"], "role": "trigger"}, {"type": "Money", "start": 62, "end": 64, "text": ["$", "200"], "role": "Price"}, {"type": "Ransom", "start": 48, "end": 49, "text": ["attacks"], "role": "trigger"}, {"type": "Ransom", "start": 24, "end": 26, "text": ["The", "attacks"], "role": "trigger"}, {"type": "Ransom", "start": 31, "end": 35, "text": ["the", "MongoDB", "ransomware", "attacks"], "role": "trigger"}, {"type": "Time", "start": 37, "end": 40, "text": ["earlier", "this", "year"], "role": "Time"}, {"type": "Ransom", "start": 16, "end": 20, "text": ["a", "wide", "ransomware", "attack"], "role": "trigger"}, {"type": "System", "start": 21, "end": 23, "text": ["MySQL", "databases"], "role": "Victim"}, {"type": "Ransom", "start": 79, "end": 81, "text": ["the", "attack"], "role": "trigger"}, {"type": "PaymentMethod", "start": 82, "end": 85, "text": ["two", "bitcoin", "wallets"], "role": "Payment-Method"}, {"type": "Ransom", "start": 251, "end": 254, "text": ["a", "payment", "demand"], "role": "trigger"}, {"type": "PaymentMethod", "start": 247, "end": 250, "text": ["a", "bitcoin", "address"], "role": "Payment-Method"}], "relations": [{"type": "Effect", "head": 0, "tail": 2}, {"type": "Effect", "head": 0, "tail": 3}, {"type": "Effect", "head": 10, "tail": 11}, {"type": "Effect", "head": 12, "tail": 13}, {"type": "Effect", "head": 14, "tail": 15}], "POS": ["JJ", "NN", "PRP", "RB", "VBD", "IN", "DT", "NNP", "NNP", "NNP", "NNP", "(", "NNP", ")", "VBZ", "VBN", "DT", "JJ", "NN", "NN", "VBG", "NNP", "NNS", ".", "DT", "NNS", "VBP", "IN", "DT", "NN", "IN", "DT", "NNP", "NN", "NNS", "RB", "VBD", "RBR", "DT", "NN", "IN", "NNP", "NNP", ".", "RB", "TO", "DT", "NNP", "NNS", ",", "NNS", "VBP", "VBN", "TO", "VB", "DT", "CD", "NNP", "NN", "(", "JJ", ".", "$", "CD", ")", "TO", "VB", "NN", "TO", "PRP$", "NN", ".", "PRP", "VBD", "CD", "RB", "JJ", "NNS", "IN", "DT", "NN", "VBG", "CD", "JJ", "NNS", ".", "IN", "DT", "NN", "PRP", "MD", "VB", "IN", "NN", "DT", "NN", "NN", "CC", "VB", "DT", "NNS", "IN", "WRB", "TO", "VB", "PRP$", "NNS", "IN", "JJ", "NNS", "IN", "IN", "NN", "NNP", ".", "DT", "NNS", "VBD", "IN", "NN", "IN", "CD", "IN", "NNP", "CD", "CC", "VBD", "IN", "CD", "NNS", "IN", "WDT", "NNS", "IN", "NNS", "VBD", "VBN", "IN", "NNP", ".", "PRP", "VBD", "JJ", "TO", "VB", "PDT", "DT", "NNS", "TO", "CD", ",", "DT", "NNP", "NN", "VBN", "IN", "NN", ",", "DT", "NNP", ":", "VBN", "IN", "VBG", "NN", ".", "DT", "NN", "VBZ", "(", "RB", ")", "VBG", "IN", "DT", "JJ", "NN", "NN", "WDT", "RB", "VBZ", "IN", "NNP", "(", "NN", ")", "CC", "NNP", "NN", ".", "NNP", "VBD", "VBN", "DT", "JJ", "NNS", "IN", "PRP", "VBD", "DT", "NN", ".", "DT", "NN", "VBZ", "IN", "NNP", "NN", "NNP", "NN", "NN", ":", "NN", ".", "RB", "VBD", ":", "IN", ",", "PRP", "VBZ", "DT", "NN", "IN", "DT", "VBG", "NNP", "NNS", "CC", "PRP$", "NNS", "CC", "VBZ", "DT", "JJ", "NN", "VBN", "CD", "NNP", "NN", "WDT", "VBZ", "DT", "NN", "NN", "NN", ",", "DT", "NN", "NN", "CC", "DT", "NN", "NN", ".", "IN", "CD", "NN", "IN", "DT", "NN", "DT", "NN", "VBZ", "VBN", "TO", "DT", "VBG", "NN", ":", "IN", "JJ", "NNS", "DT", "NN", "VBZ", "VBN", "TO", "DT", "RB", "VBN", "NN", "VBN", "CD", "NNP", "NNP", ".", "DT", "NN", "MD", "RB", "VB", "DT", "NNS", "VBN", "IN", "DT", "NN", "CC", "NN", ",", "RB", "IN", "RB", "VBG", "PRP", "RB", ".", "DT", "NN", "IN", "VBN", "IN", "NNP", "NNP", "PRP", "VBD", "CD", "NNS", "IN", "DT", "JJ", "NN", ":", "NNP", "NNP", "NNP", ".", "``", "NN", "``", "(", "NN", ",", "NN", ",", "NNP", ",", "NNP", ")", "NNP", "(", "$", "CD", "NNP", ",", "NNP", "NNP", "CD", "NNP", "TO", "DT", "NN", "CC", "NN", "DT", "NN", "IN", "PRP$", "NN", "CC", "NN", "IN", "PRP$", "NN", "TO", "VB", "PRP$", "NN", ".", "PRP$", "NNP", "VBZ", "VBN", "RP", "TO", "PRP$", "NNS", ".", "NN", ",", "VBZ", "CD", "NN", ",", "NNP", "NNP", "NNP", ")", "NNP", "NNP", "``", "NN", "``", "(", "NN", ",", "VBG", ")", "NNP", "(", "CD", ",", "NNP", "NNP", "CD", "NNP", "NNP", "NNP", "NNP", "CD", "NNP", "NNP", "NNP", "NNP", "NNP", "NN", "NNP", "NNP", "NNP", "NN", ".", "DT", "JJ", "NN", "VBZ", "DT", "NN", "TO", "VB", "DT", "JJ", "NN", "WP", "NN", "NN", "NN", "NN", "TO", "VB", "DT", "VBN", "NN", ".", "DT", "NN", "NN", "NN", "VBN", "IN", "DT", "JJ", "NN", ".", "DT", "NN", "VBZ", "DT", "JJ", "NN", "NN", ",", "CD", "NN", "CD", "CC", "VBN", "IN", "NNP", "JJ", "NN", "NNS", "VBP", "VBN", "VBG", "RP", "."]}