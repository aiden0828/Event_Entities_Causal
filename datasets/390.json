{"tokens": ["A", "decade", "ago", ",", "cross-site", "request", "forgery", "(", "CSRF", ",", "often", "pronounced", "\u201c", "c", "-", "surf", "\u201d", ")", "was", "considered", "to", "be", "a", "sleeping", "giant", ",", "preparing", "to", "wake", "and", "inflict", "havoc", "on", "the", "Worldwide", "Web", ".", "But", "the", "doomsday", "scenario", "never", "materialized", "and", "you", "do", "n\u2019t", "even", "seem", "to", "hear", "much", "about", "it", "anymore", ".", "In", "this", "blog", "post", ",", "part", "1", "of", "2", ",", "I", "will", "explore", "this", "idea", "and", "try", "to", "understand", "why", "the", "CSRF", "giant", "never", "awoke", ".", "First", "we", "\u2019ll", "cover", "the", "overall", "threat", "landscape", ",", "trends", ",", "and", "some", "notable", "CSRF", "exploits", "throughout", "the", "years", ",", "including", "one", "from", "personal", "experience", ".", "As", "a", "quick", "review", ",", "CSRF", "exists", "because", "web", "applications", "trust", "the", "cookies", "sent", "by", "web", "browsers", "within", "an", "HTTP", "request", ".", "In", "a", "CSRF", "attack", ",", "the", "attacker", "causes", "a", "victim", "\u2019s", "browser", "to", "make", "a", "request", "that", "results", "in", "a", "change", "or", "action", "which", "benefits", "the", "attacker", "(", "and", "/", "or", "harms", "the", "victim", ")", "in", "some", "way", ".", "Without", "a", "specific", "defense", "\u2013", "like", "a", "random", "token", "in", "the", "request", "body", "that", "is", "validated", "on", "the", "server", "side", "\u2013", "CSRF", "attacks", "are", "possible", ".", "After", "a", "bit", "of", "testing", ",", "my", "suspicions", "were", "confirmed", ".", "All", "requests", "that", "caused", "any", "sort", "of", "change", "could", "be", "exploited", "with", "CSRF", ".", "This", "included", ":", "I", "contacted", "the", "company", "to", "let", "them", "know", "about", "these", "security", "holes", ".", "Surprisingly", ",", "they", "did", "n\u2019t", "seem", "to", "be", "aware", "there", "was", "such", "a", "thing", "as", "CSRF", ",", "but", "they", "thanked", "me", "anyway", "and", "rolled", "out", "a", "fix", "about", "a", "month", "later", ".", "There", "have", "been", "other", "notable", "instances", "of", "CSRF", "vulnerabilities", "with", "some", "of", "them", "being", "exploited", "in", "the", "wild", ".", "Drive", "-", "by", "pharming", "is", "an", "attack", "on", "the", "DNS", "settings", "of", "home", "routers", "and", "modems", "and", "often", "leverages", "CSRF", "as", "a", "key", "element", ".", "The", "web", "UIs", "on", "these", "devices", "are", "the", "culprit", ",", "because", "they", "allow", "users", "to", "edit", "configuration", "settings", ".", "In", "one", "attack", "from", "2008", ",", "banking", "customers", "in", "Mexico", "who", "owned", "2Wire", "DSL", "modems", "were", "targeted", ".", "Victims", "received", "an", "email", "with", "an", "embedded", "image", "tag", "with", "a", "CSRF", "attack", "that", "changed", "the", "DNS", "settings", "on", "their", "modem", ".", "In", "another", "instance", ",", "tens", "of", "thousands", "of", "Twitter", "users", "fell", "victim", "to", "a", "CSRF", "worm", "in", "2010", "when", "developers", "failed", "to", "implement", "anti-CSRF", "measures", "for", "tweets", ".", "The", "vulnerability", "was", "discovered", "and", "exploited", "in", "a", "rather", "distasteful", "but", "harmless", "way", ".", "When", "authenticated", "Twitter", "users", "visited", "the", "web", "page", "containing", "the", "exploit", ",", "they", "unknowingly", "posted", "two", "tweets", "\u2013", "one", "with", "a", "link", "to", "the", "same", "page", "and", "another", "with", "a", "message", "about", "goats", ".", "Anyone", "who", "clicked", "on", "the", "link", "in", "the", "first", "tweet", "also", "posted", "the", "same", "two", "tweets", ".", "The", "worm", "spread", "like", "wildfire", "before", "it", "was", "fixed", "by", "Twitter", ".", "In", "2012", "Facebook", "\u2019s", "App", "Center", "was", "vulnerable", "to", "CSRF", "and", "the", "security", "researcher", "who", "discovered", "the", "flaw", "was", "awarded", "$", "5000", "as", "a", "bounty", ".", "Interestingly", ",", "in", "this", "case", "the", "HTTP", "request", "included", "an", "anti-CSRF", "token", "that", "appeared", "at", "first", "glance", "to", "provide", "protection", ",", "but", "the", "token", "was", "not", "being", "validated", "by", "the", "server", "-", "side", "application", "when", "the", "request", "was", "received", ".", "A", "Qualys", "researcher", "found", "other", "examples", "where", "anti-CSRF", "tokens", "were", "not", "properly", "validated", ".", "And", "similar", "to", "the", "Facebook", "issue", "mentioned", "above", ",", "PayPal", "in", "2016", "did", "not", "validate", "the", "anti-CSRF", "token", "in", "paypal.me", ".", "An", "attacker", "could", "only", "change", "a", "user", "\u2019s", "profile", "photo", "in", "that", "case", "however", "."], "entities": [{"type": "DiscoverVulnerability", "start": 401, "end": 403, "text": ["was", "discovered"], "role": "trigger"}, {"type": "Vulnerability", "start": 399, "end": 401, "text": ["The", "vulnerability"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 404, "end": 405, "text": ["exploited"], "role": "trigger"}, {"type": "DiscoverVulnerability", "start": 228, "end": 231, "text": ["let", "them", "know"], "role": "trigger"}, {"type": "Vulnerability", "start": 233, "end": 235, "text": ["security", "holes"], "role": "Vulnerability"}, {"type": "Person", "start": 223, "end": 224, "text": ["I"], "role": "Discoverer"}, {"type": "Organization", "start": 225, "end": 227, "text": ["the", "company"], "role": "Vulnerable_System_Owner"}, {"type": "DiscoverVulnerability", "start": 281, "end": 283, "text": ["being", "exploited"], "role": "trigger"}, {"type": "Vulnerability", "start": 275, "end": 277, "text": ["CSRF", "vulnerabilities"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 482, "end": 484, "text": ["was", "vulnerable"], "role": "trigger"}, {"type": "Organization", "start": 478, "end": 479, "text": ["Facebook"], "role": "Vulnerable_System_Owner"}, {"type": "Capabilities", "start": 485, "end": 486, "text": ["CSRF"], "role": "Capabilities"}, {"type": "Time", "start": 477, "end": 478, "text": ["2012"], "role": "Time"}, {"type": "System", "start": 480, "end": 482, "text": ["App", "Center"], "role": "Vulnerable_System"}, {"type": "DiscoverVulnerability", "start": 491, "end": 492, "text": ["discovered"], "role": "trigger"}, {"type": "Person", "start": 487, "end": 490, "text": ["the", "security", "researcher"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 492, "end": 494, "text": ["the", "flaw"], "role": "Vulnerability"}, {"type": "PatchVulnerability", "start": 259, "end": 261, "text": ["rolled", "out"], "role": "trigger"}, {"type": "Organization", "start": 254, "end": 255, "text": ["they"], "role": "Releaser"}, {"type": "Time", "start": 264, "end": 267, "text": ["a", "month", "later"], "role": "Time"}, {"type": "Patch", "start": 261, "end": 263, "text": ["a", "fix"], "role": "Patch"}], "relations": [{"type": "Causal", "head": 1, "tail": 0}, {"type": "Causal", "head": 4, "tail": 3}, {"type": "Causal", "head": 5, "tail": 3}, {"type": "Causal", "head": 8, "tail": 7}, {"type": "Causal", "head": 11, "tail": 9}, {"type": "Causal", "head": 15, "tail": 14}, {"type": "Causal", "head": 16, "tail": 14}, {"type": "Causal", "head": 18, "tail": 17}], "POS": ["DT", "NN", "RB", ",", "JJ", "NN", "NN", "(", "NNP", ",", "RB", "VBD", "NNP", "SYM", ":", "NN", "NN", ")", "VBD", "VBN", "TO", "VB", "DT", "NN", "NN", ",", "VBG", "TO", "VB", "CC", "VB", "NN", "IN", "DT", "NNP", "NNP", ".", "CC", "DT", "NN", "NN", "RB", "VBN", "CC", "PRP", "VBP", "RB", "RB", "VBP", "TO", "VB", "JJ", "IN", "PRP", "RB", ".", "IN", "DT", "NN", "NN", ",", "NN", "CD", "IN", "CD", ",", "PRP", "MD", "VB", "DT", "NN", "CC", "VB", "TO", "VB", "WRB", "DT", "NNP", "NN", "RB", "VBD", ".", "NNP", "PRP", "VBP", "VB", "DT", "JJ", "NN", "NN", ",", "NNS", ",", "CC", "DT", "JJ", "NNP", "NNS", "IN", "DT", "NNS", ",", "VBG", "CD", "IN", "JJ", "NN", ".", "IN", "DT", "JJ", "NN", ",", "NNP", "VBZ", "IN", "NN", "NNS", "VBP", "DT", "NNS", "VBN", "IN", "NN", "NNS", "IN", "DT", "NNP", "NN", ".", "IN", "DT", "NNP", "NN", ",", "DT", "NN", "VBZ", "DT", "NN", "NNP", "NN", "TO", "VB", "DT", "NN", "WDT", "NNS", "IN", "DT", "NN", "CC", "NN", "WDT", "NNS", "DT", "NN", "(", "CC", "NNP", "CC", "VBZ", "DT", "NN", ")", "IN", "DT", "NN", ".", "IN", "DT", "JJ", "NN", "NN", "IN", "DT", "NN", "NN", "IN", "DT", "NN", "NN", "WDT", "VBZ", "VBN", "IN", "DT", "JJ", "NN", "NNP", "NNP", "NNS", "VBP", "JJ", ".", "IN", "DT", "NN", "IN", "VBG", ",", "PRP$", "NNS", "VBD", "VBN", ".", "DT", "NNS", "WDT", "VBD", "DT", "NN", "IN", "NN", "MD", "VB", "VBN", "IN", "NNP", ".", "DT", "VBD", ":", "PRP", "VBD", "DT", "NN", "TO", "VB", "PRP", "VB", "IN", "DT", "NN", "NNS", ".", "RB", ",", "PRP", "VBD", "RB", "VB", "TO", "VB", "JJ", "EX", "VBD", "JJ", "DT", "NN", "IN", "NNP", ",", "CC", "PRP", "VBD", "PRP", "RB", "CC", "VBD", "RP", "DT", "NN", "IN", "DT", "NN", "RB", ".", "EX", "VBP", "VBN", "JJ", "JJ", "NNS", "IN", "NNP", "NNS", "IN", "DT", "IN", "PRP", "VBG", "VBN", "IN", "DT", "JJ", ".", "NNP", ":", "IN", "VBG", "VBZ", "DT", "NN", "IN", "DT", "NNP", "NNS", "IN", "NN", "NNS", "CC", "NNS", "CC", "RB", "VBZ", "NNP", "IN", "DT", "JJ", "NN", ".", "DT", "NN", "NNP", "IN", "DT", "NNS", "VBP", "DT", "NN", ",", "IN", "PRP", "VBP", "NNS", "TO", "VB", "NN", "NNS", ".", "IN", "CD", "NN", "IN", "CD", ",", "VBG", "NNS", "IN", "NNP", "WP", "VBD", "CD", "NNP", "NNS", "VBD", "VBN", ".", "NNP", "VBD", "DT", "NN", "IN", "DT", "JJ", "NN", "NN", "IN", "DT", "NNP", "NN", "WDT", "VBD", "DT", "NNP", "NNS", "IN", "PRP$", "NN", ".", "IN", "DT", "NN", ",", "NNS", "IN", "NNS", "IN", "NNP", "NNS", "VBD", "RB", "TO", "DT", "NNP", "NN", "IN", "CD", "WRB", "NNS", "VBD", "TO", "VB", "JJ", "NNS", "IN", "NNS", ".", "DT", "NN", "VBD", "VBN", "CC", "VBN", "IN", "DT", "RB", "JJ", "CC", "JJ", "NN", ".", "WRB", "JJ", "NNP", "NNS", "VBD", "DT", "JJ", "NN", "VBG", "DT", "NN", ",", "PRP", "RB", "VBD", "CD", "NNS", "VBP", "CD", "IN", "DT", "NN", "TO", "DT", "JJ", "NN", "CC", "DT", "IN", "DT", "NN", "IN", "NNS", ".", "NN", "WP", "VBD", "IN", "DT", "NN", "IN", "DT", "JJ", "NN", "RB", "VBD", "DT", "JJ", "CD", "NNS", ".", "DT", "NN", "NN", "IN", "NN", "IN", "PRP", "VBD", "VBN", "IN", "NNP", ".", "IN", "CD", "NNP", "NNP", "NNP", "NNP", "VBD", "JJ", "TO", "NNP", "CC", "DT", "NN", "NN", "WP", "VBD", "DT", "NN", "VBD", "VBN", "$", "CD", "IN", "DT", "NN", ".", "NNP", ",", "IN", "DT", "NN", "DT", "NNP", "NN", "VBD", "DT", "JJ", "NN", "WDT", "VBD", "IN", "JJ", "NN", "TO", "VB", "NN", ",", "CC", "DT", "NN", "VBD", "RB", "VBG", "VBN", "IN", "DT", "NN", ":", "NN", "NN", "WRB", "DT", "NN", "VBD", "VBN", ".", "DT", "NNP", "NN", "VBD", "JJ", "NNS", "WRB", "JJ", "NNS", "VBD", "RB", "RB", "VBN", ".", "CC", "JJ", "TO", "DT", "NNP", "NN", "VBD", "IN", ",", "NNP", "IN", "CD", "VBD", "RB", "VB", "DT", "JJ", "NN", "IN", "NN", ".", "DT", "NN", "MD", "RB", "VB", "DT", "NN", "NN", "NN", "NN", "IN", "DT", "NN", "RB", "."]}