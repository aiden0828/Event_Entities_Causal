{"tokens": ["Home", "routers", "are", "the", "first", "and", "sometimes", "last", "line", "of", "defense", "for", "a", "network", ".", "Despite", "this", "fact", ",", "many", "manufacturers", "of", "home", "routers", "fail", "to", "properly", "audit", "their", "devices", "for", "security", "issues", "before", "releasing", "them", "to", "the", "market", ".", "As", "security", "researchers", ",", "we", "are", "often", "disappointed", "to", "rediscover", "that", "this", "is", "not", "always", "the", "case", ",", "and", "that", "sometimes", "these", "vulnerabilities", "simply", "fall", "into", "our", "hands", "during", "our", "day", "-", "to", "-", "day", "lives", ".", "Such", "is", "the", "story", "of", "the", "two", "NETGEAR", "vulnerabilities", "I", "want", "to", "share", "with", "you", "today", ":", "It", "was", "a", "cold", "and", "rainy", "winter", "night", ",", "almost", "a", "year", "ago", ",", "when", "my", "lovely", "NETGEAR", "VEGN2610", "modem", "/", "router", "lost", "connection", "to", "the", "Internet", ".", "I", "was", "tucked", "in", "bed", ",", "cozy", "and", "warm", ",", "there", "was", "no", "way", "I", "was", "going", "downstairs", "to", "reset", "the", "modem", ",", "\"", "I", "will", "just", "reboot", "it", "through", "the", "web", "panel", "\"", "I", "thought", "to", "myself", ".", "Unfortunately", "I", "could", "n't", "remember", "the", "password", "and", "it", "was", "too", "late", "at", "night", "to", "check", "whether", "my", "roommates", "had", "it", ".", "I", "considered", "my", "options", ":", "Needless", "to", "say", ",", "I", "chose", "the", "latter", ".", "I", "thought", "to", "myself", ",", "\"", "Well", ",", "it", "has", "a", "web", "interface", "and", "I", "need", "to", "bypass", "the", "authentication", "somehow", ",", "so", "the", "web", "server", "is", "a", "good", "start", ".", "\"", "I", "started", "manually", "fuzzing", "the", "web", "server", "with", "different", "parameters", ",", "I", "tried", "\"", ".", ".", "/", ".", ".", "\"", "classic", "directory", "traversal", "and", "such", ",", "and", "after", "about", "1", "minute", "of", "fuzzing", ",", "I", "tried", "\"", "\u2026", "\"", "and", "I", "got", "this", "response", ":", "Fig", "1", ":", "unauth.cgi", "\"", "Hmm", ",", "what", "is", "that", "unauth.cgi", "thingy", "?", "Luckily", "for", "me", "the", "Internet", "connection", "had", "come", "back", "on", "its", "own", ",", "but", "I", "was", "now", "a", "man", "on", "a", "mission", ",", "so", "I", "started", "to", "look", "around", "to", "see", "if", "there", "were", "any", "known", "vulnerabilities", "for", "my", "VEGN2610", ".", "I", "started", "looking", "up", "what", "that", "\"", "unauth.cgi", "\"", "page", "could", "be", ",", "and", "I", "found", "2", "publicly", "disclosed", "exploits", "from", "2014", ",", "for", "different", "models", "that", "manage", "to", "do", "unauthenticated", "password", "disclosure", ".", "Those", "two", "guys", "found", "out", "that", "the", "number", "we", "get", "from", "unauth.cgi", "can", "be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials", ".", "I", "tested", "the", "method", "described", "in", "both", ",", "and", "voila", "-", "I", "have", "my", "password", ",", "now", "I", "can", "go", "to", "sleep", "happy", "and", "satisfied", ".", "I", "woke", "up", "the", "next", "morning", "excited", "by", "the", "discovery", ",", "I", "thought", "to", "myself", ":", "\"", "3", "routers", "with", "same", "issue", "\u2026", "Coincidence", "?", "Luckily", ",", "I", "had", "another", ",", "older", "NETGEAR", "router", "laying", "around", ";", "I", "tested", "it", "and", "bam", "!", "I", "started", "asking", "people", "I", "knew", "if", "they", "have", "NETGEAR", "equipment", "so", "I", "could", "test", "further", "to", "see", "the", "scope", "of", "the", "issue", ".", "In", "order", "to", "make", "life", "easier", "for", "non-technical", "people", "I", "wrote", "a", "python", "script", "called", "netgore", ",", "similar", "to", "wnroast", ",", "to", "test", "for", "this", "issue", ".", "I", "am", "aware", "of", "that", "and", "that", "is", "why", "I", "do", "n't", "work", "as", "a", "full", "time", "programmer", ".", "As", "it", "turned", "out", ",", "I", "had", "an", "error", "in", "my", "code", "where", "it", "did", "n't", "correctly", "take", "the", "number", "from", "unauth.cgi", "and", "passed", "gibberish", "to", "passwordrecovered.cgi", "instead", ",", "but", "somehow", "it", "still", "managed", "to", "get", "the", "credentials", "!", "After", "few", "trials", "and", "errors", "trying", "to", "reproduce", "the", "issue", ",", "I", "found", "that", "the", "very", "first", "call", "to", "passwordrecovered.cgi", "will", "give", "out", "the", "credentials", "no", "matter", "what", "the", "parameter", "you", "send", ".", "This", "is", "totally", "new", "bug", "that", "I", "have", "n't", "seen", "anywhere", "else", ".", "When", "I", "tested", "both", "bugs", "on", "different", "NETGEAR", "models", ",", "I", "found", "that", "my", "second", "bug", "works", "on", "a", "much", "wider", "range", "of", "models", ".", "A", "full", "description", "of", "both", "of", "these", "findings", "as", "well", "as", "the", "python", "script", "used", "for", "testing", "can", "be", "found", "here", ".", "The", "vulnerabilities", "have", "been", "assigned", "CVE", "-2017-5521", "and", "TWSL2017", "-", "003", ".", "The", "Responsible", "Disclosure", "Process", "This", "is", "where", "the", "story", "of", "discovery", "ends", "and", "the", "story", "of", "disclosure", "begins", ".", "Following", "our", "Responsible", "Disclosure", "policy", "we", "sent", "both", "findings", "to", "NETGEAR", "in", "the", "beginning", "of", "April", "2016", ".", "In", "our", "initial", "contact", ",", "the", "first", "advisory", "had", "18", "models", "listed", "as", "vulnerable", ",", "although", "six", "of", "them", "did", "n't", "have", "the", "vulnerability", "in", "the", "latest", "firmware", ".", "Perhaps", "it", "was", "fixed", "as", "part", "of", "a", "different", "patch", "cycle", ".", "The", "second", "advisory", "included", "25", "models", ",", "all", "of", "which", "were", "vulnerable", "in", "their", "latest", "firmware", "version", ".", "In", "June", "NETGEAR", "published", "a", "notice", "that", "provided", "a", "fix", "for", "a", "small", "subset", "of", "vulnerable", "routers", "and", "a", "workaround", "for", "the", "rest", ".", "They", "also", "made", "the", "commitment", "to", "working", "toward", "100", "%", "coverage", "for", "all", "affected", "routers", ".", "The", "notice", "has", "been", "updated", "several", "time", "since", "then", "and", "currently", "contains", "31", "vulnerable", "models", ",", "18", "of", "which", "are", "patched", "now", ",", "and", "2", "models", "that", "they", "previously", "listed", "as", "vulnerable", ",", "but", "are", "now", "listed", "as", "not", "vulnerable", ".", "In", "fact", ",", "our", "tests", "show", "that", "one", "of", "the", "models", "listed", "as", "not", "vulnerable", "(", "DGN2200v4", ")", "is", ",", "in", "fact", ",", "vulnerable", "and", "this", "can", "easily", "be", "reproduced", "with", "the", "POC", "provided", "in", "our", "advisory", ".", "Over", "the", "past", "nine", "months", "we", "attempted", "to", "contact", "NETGEAR", "multiple", "times", "for", "clarification", "and", "to", "allow", "them", "time", "to", "patch", "more", "models", ".", "Over", "that", "time", "we", "have", "found", "more", "vulnerable", "models", "that", "were", "not", "listed", "in", "the", "initial", "notice", ",", "although", "they", "were", "added", "later", ".", "We", "also", "discovered", "that", "the", "Lenovo", "R3220", "router", "is", "powered", "by", "NETGEAR", "firmware", "and", "it", "was", "vulnerable", "as", "well", ".", "Luckily", "NETGEAR", "did", "eventually", "get", "back", "to", "us", "right", "before", "we", "were", "set", "to", "disclose", "these", "vulnerabilities", "publicly", ".", "We", "were", "a", "little", "skeptical", "since", "our", "experience", "to", "date", "matched", "that", "of", "other", "third", "-", "party", "vulnerability", "researchers", "that", "have", "tried", "to", "responsibly", "disclose", "to", "NETGEAR", "only", "to", "be", "met", "with", "frustration", ".", "The", "first", "was", "that", "NETGEAR", "committed", "to", "pushing", "out", "firmware", "to", "the", "currently", "unpatched", "models", "on", "an", "aggressive", "timeline", ".", "The", "second", "change", "made", "us", "more", "confident", "that", "NETGEAR", "was", "not", "just", "serious", "about", "patching", "these", "vulnerabilities", ",", "but", "serious", "about", "changing", "how", "they", "handle", "third", "-", "party", "disclosure", "in", "general", ".", "We", "fully", "expect", "this", "move", "will", "not", "only", "smooth", "the", "relationship", "between", "third", "-", "party", "researchers", "and", "NETGEAR", ",", "but", ",", "in", "the", "end", ",", "will", "result", "in", "a", "more", "secure", "line", "of", "products", "and", "services", ".", "For", "starters", ",", "it", "affects", "a", "large", "number", "of", "models", ".", "We", "have", "found", "more", "than", "ten", "thousand", "vulnerable", "devices", "that", "are", "remotely", "accessible", ".", "The", "real", "number", "of", "affected", "devices", "is", "probably", "in", "the", "hundreds", "of", "thousands", ",", "if", "not", "over", "a", "million", ".", "The", "vulnerability", "can", "be", "used", "by", "a", "remote", "attacker", "if", "remote", "administration", "is", "set", "to", "be", "Internet", "facing", "."], "trigger": [{"start": 365, "end": 366, "text": ["found", "out"], "event": "DiscoverVulnerability"}, {"start": 344, "end": 346, "text": ["2", "publicly", "disclosed"], "event": "DiscoverVulnerability"}, {"start": 87, "end": 89, "text": ["want", "to", "share"], "event": "DiscoverVulnerability"}, {"start": 574, "end": 574, "text": ["found"], "event": "DiscoverVulnerability"}, {"start": 619, "end": 619, "text": ["found"], "event": "DiscoverVulnerability"}, {"start": 657, "end": 659, "text": ["have", "been", "assigned"], "event": "DiscoverVulnerability"}, {"start": 693, "end": 694, "text": ["both", "findings"], "event": "DiscoverVulnerability"}, {"start": 715, "end": 717, "text": ["listed", "as", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 755, "end": 756, "text": ["were", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 832, "end": 834, "text": ["listed", "as", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 735, "end": 736, "text": ["was", "fixed"], "event": "PatchVulnerability"}, {"start": 770, "end": 770, "text": ["provided"], "event": "PatchVulnerability"}, {"start": 822, "end": 823, "text": ["are", "patched"], "event": "PatchVulnerability"}, {"start": 901, "end": 902, "text": ["to", "patch"], "event": "PatchVulnerability"}, {"start": 1037, "end": 1037, "text": ["patching"], "event": "PatchVulnerability"}, {"start": 839, "end": 842, "text": ["listed", "as", "not", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 855, "end": 858, "text": ["listed", "as", "not", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 910, "end": 911, "text": ["have", "found"], "event": "DiscoverVulnerability"}, {"start": 945, "end": 946, "text": ["was", "vulnerable"], "event": "DiscoverVulnerability"}, {"start": 932, "end": 932, "text": ["discovered"], "event": "DiscoverVulnerability"}, {"start": 964, "end": 964, "text": ["disclose"], "event": "DiscoverVulnerability"}, {"start": 992, "end": 993, "text": ["responsibly", "disclose"], "event": "DiscoverVulnerability"}, {"start": 1104, "end": 1105, "text": ["have", "found"], "event": "DiscoverVulnerability"}], "Entities": [[{"start": 373, "end": 373, "text": ["unauth.cgi"], "type": "Vulnerability"}, {"start": 375, "end": 382, "text": ["be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials"], "type": "Capabilities"}, {"start": 362, "end": 364, "text": ["Those", "two", "guys"], "type": "Person"}], [{"start": 349, "end": 349, "text": ["2014"], "type": "Time"}, {"start": 352, "end": 353, "text": ["different", "models"], "type": "Device"}, {"start": 355, "end": 360, "text": ["manage", "to", "do", "unauthenticated", "password", "disclosure"], "type": "Capabilities"}, {"start": 334, "end": 337, "text": ["\"", "unauth.cgi", "\"", "page"], "type": "Vulnerability"}], [{"start": 86, "end": 86, "text": ["I"], "type": "Person"}, {"start": 82, "end": 85, "text": ["the", "two", "NETGEAR", "vulnerabilities"], "type": "Vulnerability"}, {"start": 92, "end": 92, "text": ["today"], "type": "Time"}], [{"start": 570, "end": 571, "text": ["the", "issue"], "type": "Vulnerability"}, {"start": 573, "end": 573, "text": ["I"], "type": "Person"}, {"start": 581, "end": 586, "text": ["passwordrecovered.cgi", "will", "give", "out", "the", "credentials"], "type": "Capabilities"}], [{"start": 622, "end": 623, "text": ["second", "bug"], "type": "Vulnerability"}, {"start": 609, "end": 609, "text": ["I"], "type": "Person"}, {"start": 611, "end": 612, "text": ["both", "bugs"], "type": "Vulnerability"}, {"start": 618, "end": 618, "text": ["I"], "type": "Person"}, {"start": 631, "end": 631, "text": ["models"], "type": "Device"}, {"start": 615, "end": 616, "text": ["NETGEAR", "models"], "type": "Device"}], [{"start": 655, "end": 656, "text": ["The", "vulnerabilities"], "type": "Vulnerability"}, {"start": 660, "end": 661, "text": ["CVE", "-2017-5521"], "type": "CVE"}, {"start": 663, "end": 665, "text": ["TWSL2017", "-", "003"], "type": "CVE"}], [{"start": 691, "end": 691, "text": ["we"], "type": "Person"}, {"start": 696, "end": 696, "text": ["NETGEAR"], "type": "Organization"}, {"start": 701, "end": 702, "text": ["April", "2016"], "type": "Time"}], [{"start": 714, "end": 714, "text": ["models"], "type": "Device"}, {"start": 726, "end": 727, "text": ["the", "vulnerability"], "type": "Vulnerability"}, {"start": 730, "end": 731, "text": ["latest", "firmware"], "type": "Software"}], [{"start": 750, "end": 750, "text": ["models"], "type": "Device"}, {"start": 759, "end": 761, "text": ["latest", "firmware", "version"], "type": "Version"}], [{"start": 828, "end": 828, "text": ["models"], "type": "Device"}], [{"start": 734, "end": 734, "text": ["it"], "type": "Device"}, {"start": 740, "end": 743, "text": ["a", "different", "patch", "cycle"], "type": "Patch"}], [{"start": 765, "end": 765, "text": ["NETGEAR"], "type": "Organization"}, {"start": 764, "end": 764, "text": ["June"], "type": "Time"}, {"start": 778, "end": 779, "text": ["vulnerable", "routers"], "type": "Device"}, {"start": 771, "end": 772, "text": ["a", "fix"], "type": "Patch"}], [{"start": 817, "end": 817, "text": ["models"], "type": "Device"}], [{"start": 899, "end": 899, "text": ["them"], "type": "Organization"}, {"start": 891, "end": 891, "text": ["NETGEAR"], "type": "Organization"}, {"start": 903, "end": 904, "text": ["more", "models"], "type": "Device"}], [{"start": 1031, "end": 1031, "text": ["NETGEAR"], "type": "Organization"}, {"start": 1038, "end": 1039, "text": ["these", "vulnerabilities"], "type": "Vulnerability"}], [], [{"start": 854, "end": 854, "text": ["models"], "type": "Device"}, {"start": 860, "end": 860, "text": ["DGN2200v4"], "type": "Version"}], [{"start": 913, "end": 914, "text": ["vulnerable", "models"], "type": "Device"}, {"start": 909, "end": 909, "text": ["we"], "type": "Organization"}], [{"start": 944, "end": 944, "text": ["it"], "type": "Device"}], [{"start": 934, "end": 937, "text": ["the", "Lenovo", "R3220", "router"], "type": "Device"}, {"start": 941, "end": 942, "text": ["NETGEAR", "firmware"], "type": "Software"}, {"start": 930, "end": 930, "text": ["We"], "type": "Organization"}], [{"start": 965, "end": 966, "text": ["these", "vulnerabilities"], "type": "Vulnerability"}, {"start": 960, "end": 960, "text": ["we"], "type": "Organization"}], [{"start": 983, "end": 987, "text": ["third", "-", "party", "vulnerability", "researchers"], "type": "Person"}, {"start": 995, "end": 995, "text": ["NETGEAR"], "type": "Organization"}], [{"start": 1103, "end": 1103, "text": ["We"], "type": "Organization"}, {"start": 1110, "end": 1111, "text": ["vulnerable", "devices"], "type": "Device"}, {"start": 1114, "end": 1115, "text": ["remotely", "accessible"], "type": "Capabilities"}]], "Causal": [[{"start": 373, "end": 373, "text": ["unauth.cgi"], "type": "Vulnerability"}, {"start": 362, "end": 364, "text": ["Those", "two", "guys"], "type": "Person"}], [{"start": 334, "end": 337, "text": ["\"", "unauth.cgi", "\"", "page"], "type": "Vulnerability"}], [{"start": 86, "end": 86, "text": ["I"], "type": "Person"}, {"start": 82, "end": 85, "text": ["the", "two", "NETGEAR", "vulnerabilities"], "type": "Vulnerability"}], [{"start": 570, "end": 571, "text": ["the", "issue"], "type": "Vulnerability"}, {"start": 573, "end": 573, "text": ["I"], "type": "Person"}], [{"start": 622, "end": 623, "text": ["second", "bug"], "type": "Vulnerability"}, {"start": 618, "end": 618, "text": ["I"], "type": "Person"}], [{"start": 660, "end": 661, "text": ["CVE", "-2017-5521"], "type": "CVE"}, {"start": 663, "end": 665, "text": ["TWSL2017", "-", "003"], "type": "CVE"}], [{"start": 691, "end": 691, "text": ["we"], "type": "Person"}], [{"start": 726, "end": 727, "text": ["the", "vulnerability"], "type": "Vulnerability"}], [], [], [{"start": 734, "end": 734, "text": ["it"], "type": "Device"}, {"start": 740, "end": 743, "text": ["a", "different", "patch", "cycle"], "type": "Patch"}], [{"start": 765, "end": 765, "text": ["NETGEAR"], "type": "Organization"}], [], [{"start": 891, "end": 891, "text": ["NETGEAR"], "type": "Organization"}], [{"start": 1031, "end": 1031, "text": ["NETGEAR"], "type": "Organization"}, {"start": 1038, "end": 1039, "text": ["these", "vulnerabilities"], "type": "Vulnerability"}], [], [], [{"start": 909, "end": 909, "text": ["we"], "type": "Organization"}], [], [{"start": 930, "end": 930, "text": ["We"], "type": "Organization"}], [{"start": 965, "end": 966, "text": ["these", "vulnerabilities"], "type": "Vulnerability"}, {"start": 960, "end": 960, "text": ["we"], "type": "Organization"}], [{"start": 983, "end": 987, "text": ["third", "-", "party", "vulnerability", "researchers"], "type": "Person"}], [{"start": 1103, "end": 1103, "text": ["We"], "type": "Organization"}]], "Effect": [[{"start": 375, "end": 382, "text": ["be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials"], "type": "Capabilities"}], [{"start": 355, "end": 360, "text": ["manage", "to", "do", "unauthenticated", "password", "disclosure"], "type": "Capabilities"}], [], [{"start": 581, "end": 586, "text": ["passwordrecovered.cgi", "will", "give", "out", "the", "credentials"], "type": "Capabilities"}], [{"start": 631, "end": 631, "text": ["models"], "type": "Device"}, {"start": 615, "end": 616, "text": ["NETGEAR", "models"], "type": "Device"}], [], [{"start": 696, "end": 696, "text": ["NETGEAR"], "type": "Organization"}], [{"start": 714, "end": 714, "text": ["models"], "type": "Device"}], [{"start": 750, "end": 750, "text": ["models"], "type": "Device"}, {"start": 759, "end": 761, "text": ["latest", "firmware", "version"], "type": "Version"}], [{"start": 828, "end": 828, "text": ["models"], "type": "Device"}], [], [{"start": 778, "end": 779, "text": ["vulnerable", "routers"], "type": "Device"}, {"start": 771, "end": 772, "text": ["a", "fix"], "type": "Patch"}], [{"start": 817, "end": 817, "text": ["models"], "type": "Device"}], [{"start": 903, "end": 904, "text": ["more", "models"], "type": "Device"}], [], [], [{"start": 860, "end": 860, "text": ["DGN2200v4"], "type": "Version"}], [{"start": 913, "end": 914, "text": ["vulnerable", "models"], "type": "Device"}], [{"start": 944, "end": 944, "text": ["it"], "type": "Device"}], [{"start": 934, "end": 937, "text": ["the", "Lenovo", "R3220", "router"], "type": "Device"}, {"start": 941, "end": 942, "text": ["NETGEAR", "firmware"], "type": "Software"}], [], [{"start": 995, "end": 995, "text": ["NETGEAR"], "type": "Organization"}], [{"start": 1110, "end": 1111, "text": ["vulnerable", "devices"], "type": "Device"}, {"start": 1114, "end": 1115, "text": ["remotely", "accessible"], "type": "Capabilities"}]]}