{"tokens": ["Home", "routers", "are", "the", "first", "and", "sometimes", "last", "line", "of", "defense", "for", "a", "network", ".", "Despite", "this", "fact", ",", "many", "manufacturers", "of", "home", "routers", "fail", "to", "properly", "audit", "their", "devices", "for", "security", "issues", "before", "releasing", "them", "to", "the", "market", ".", "As", "security", "researchers", ",", "we", "are", "often", "disappointed", "to", "rediscover", "that", "this", "is", "not", "always", "the", "case", ",", "and", "that", "sometimes", "these", "vulnerabilities", "simply", "fall", "into", "our", "hands", "during", "our", "day", "-", "to", "-", "day", "lives", ".", "Such", "is", "the", "story", "of", "the", "two", "NETGEAR", "vulnerabilities", "I", "want", "to", "share", "with", "you", "today", ":", "It", "was", "a", "cold", "and", "rainy", "winter", "night", ",", "almost", "a", "year", "ago", ",", "when", "my", "lovely", "NETGEAR", "VEGN2610", "modem", "/", "router", "lost", "connection", "to", "the", "Internet", ".", "I", "was", "tucked", "in", "bed", ",", "cozy", "and", "warm", ",", "there", "was", "no", "way", "I", "was", "going", "downstairs", "to", "reset", "the", "modem", ",", "\"", "I", "will", "just", "reboot", "it", "through", "the", "web", "panel", "\"", "I", "thought", "to", "myself", ".", "Unfortunately", "I", "could", "n't", "remember", "the", "password", "and", "it", "was", "too", "late", "at", "night", "to", "check", "whether", "my", "roommates", "had", "it", ".", "I", "considered", "my", "options", ":", "Needless", "to", "say", ",", "I", "chose", "the", "latter", ".", "I", "thought", "to", "myself", ",", "\"", "Well", ",", "it", "has", "a", "web", "interface", "and", "I", "need", "to", "bypass", "the", "authentication", "somehow", ",", "so", "the", "web", "server", "is", "a", "good", "start", ".", "\"", "I", "started", "manually", "fuzzing", "the", "web", "server", "with", "different", "parameters", ",", "I", "tried", "\"", ".", ".", "/", ".", ".", "\"", "classic", "directory", "traversal", "and", "such", ",", "and", "after", "about", "1", "minute", "of", "fuzzing", ",", "I", "tried", "\"", "\u2026", "\"", "and", "I", "got", "this", "response", ":", "Fig", "1", ":", "unauth.cgi", "\"", "Hmm", ",", "what", "is", "that", "unauth.cgi", "thingy", "?", "Luckily", "for", "me", "the", "Internet", "connection", "had", "come", "back", "on", "its", "own", ",", "but", "I", "was", "now", "a", "man", "on", "a", "mission", ",", "so", "I", "started", "to", "look", "around", "to", "see", "if", "there", "were", "any", "known", "vulnerabilities", "for", "my", "VEGN2610", ".", "I", "started", "looking", "up", "what", "that", "\"", "unauth.cgi", "\"", "page", "could", "be", ",", "and", "I", "found", "2", "publicly", "disclosed", "exploits", "from", "2014", ",", "for", "different", "models", "that", "manage", "to", "do", "unauthenticated", "password", "disclosure", ".", "Those", "two", "guys", "found", "out", "that", "the", "number", "we", "get", "from", "unauth.cgi", "can", "be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials", ".", "I", "tested", "the", "method", "described", "in", "both", ",", "and", "voila", "-", "I", "have", "my", "password", ",", "now", "I", "can", "go", "to", "sleep", "happy", "and", "satisfied", ".", "I", "woke", "up", "the", "next", "morning", "excited", "by", "the", "discovery", ",", "I", "thought", "to", "myself", ":", "\"", "3", "routers", "with", "same", "issue", "\u2026", "Coincidence", "?", "Luckily", ",", "I", "had", "another", ",", "older", "NETGEAR", "router", "laying", "around", ";", "I", "tested", "it", "and", "bam", "!", "I", "started", "asking", "people", "I", "knew", "if", "they", "have", "NETGEAR", "equipment", "so", "I", "could", "test", "further", "to", "see", "the", "scope", "of", "the", "issue", ".", "In", "order", "to", "make", "life", "easier", "for", "non-technical", "people", "I", "wrote", "a", "python", "script", "called", "netgore", ",", "similar", "to", "wnroast", ",", "to", "test", "for", "this", "issue", ".", "I", "am", "aware", "of", "that", "and", "that", "is", "why", "I", "do", "n't", "work", "as", "a", "full", "time", "programmer", ".", "As", "it", "turned", "out", ",", "I", "had", "an", "error", "in", "my", "code", "where", "it", "did", "n't", "correctly", "take", "the", "number", "from", "unauth.cgi", "and", "passed", "gibberish", "to", "passwordrecovered.cgi", "instead", ",", "but", "somehow", "it", "still", "managed", "to", "get", "the", "credentials", "!", "After", "few", "trials", "and", "errors", "trying", "to", "reproduce", "the", "issue", ",", "I", "found", "that", "the", "very", "first", "call", "to", "passwordrecovered.cgi", "will", "give", "out", "the", "credentials", "no", "matter", "what", "the", "parameter", "you", "send", ".", "This", "is", "totally", "new", "bug", "that", "I", "have", "n't", "seen", "anywhere", "else", ".", "When", "I", "tested", "both", "bugs", "on", "different", "NETGEAR", "models", ",", "I", "found", "that", "my", "second", "bug", "works", "on", "a", "much", "wider", "range", "of", "models", ".", "A", "full", "description", "of", "both", "of", "these", "findings", "as", "well", "as", "the", "python", "script", "used", "for", "testing", "can", "be", "found", "here", ".", "The", "vulnerabilities", "have", "been", "assigned", "CVE", "-2017-5521", "and", "TWSL2017", "-", "003", ".", "The", "Responsible", "Disclosure", "Process", "This", "is", "where", "the", "story", "of", "discovery", "ends", "and", "the", "story", "of", "disclosure", "begins", ".", "Following", "our", "Responsible", "Disclosure", "policy", "we", "sent", "both", "findings", "to", "NETGEAR", "in", "the", "beginning", "of", "April", "2016", ".", "In", "our", "initial", "contact", ",", "the", "first", "advisory", "had", "18", "models", "listed", "as", "vulnerable", ",", "although", "six", "of", "them", "did", "n't", "have", "the", "vulnerability", "in", "the", "latest", "firmware", ".", "Perhaps", "it", "was", "fixed", "as", "part", "of", "a", "different", "patch", "cycle", ".", "The", "second", "advisory", "included", "25", "models", ",", "all", "of", "which", "were", "vulnerable", "in", "their", "latest", "firmware", "version", ".", "In", "June", "NETGEAR", "published", "a", "notice", "that", "provided", "a", "fix", "for", "a", "small", "subset", "of", "vulnerable", "routers", "and", "a", "workaround", "for", "the", "rest", ".", "They", "also", "made", "the", "commitment", "to", "working", "toward", "100", "%", "coverage", "for", "all", "affected", "routers", ".", "The", "notice", "has", "been", "updated", "several", "time", "since", "then", "and", "currently", "contains", "31", "vulnerable", "models", ",", "18", "of", "which", "are", "patched", "now", ",", "and", "2", "models", "that", "they", "previously", "listed", "as", "vulnerable", ",", "but", "are", "now", "listed", "as", "not", "vulnerable", ".", "In", "fact", ",", "our", "tests", "show", "that", "one", "of", "the", "models", "listed", "as", "not", "vulnerable", "(", "DGN2200v4", ")", "is", ",", "in", "fact", ",", "vulnerable", "and", "this", "can", "easily", "be", "reproduced", "with", "the", "POC", "provided", "in", "our", "advisory", ".", "Over", "the", "past", "nine", "months", "we", "attempted", "to", "contact", "NETGEAR", "multiple", "times", "for", "clarification", "and", "to", "allow", "them", "time", "to", "patch", "more", "models", ".", "Over", "that", "time", "we", "have", "found", "more", "vulnerable", "models", "that", "were", "not", "listed", "in", "the", "initial", "notice", ",", "although", "they", "were", "added", "later", ".", "We", "also", "discovered", "that", "the", "Lenovo", "R3220", "router", "is", "powered", "by", "NETGEAR", "firmware", "and", "it", "was", "vulnerable", "as", "well", ".", "Luckily", "NETGEAR", "did", "eventually", "get", "back", "to", "us", "right", "before", "we", "were", "set", "to", "disclose", "these", "vulnerabilities", "publicly", ".", "We", "were", "a", "little", "skeptical", "since", "our", "experience", "to", "date", "matched", "that", "of", "other", "third", "-", "party", "vulnerability", "researchers", "that", "have", "tried", "to", "responsibly", "disclose", "to", "NETGEAR", "only", "to", "be", "met", "with", "frustration", ".", "The", "first", "was", "that", "NETGEAR", "committed", "to", "pushing", "out", "firmware", "to", "the", "currently", "unpatched", "models", "on", "an", "aggressive", "timeline", ".", "The", "second", "change", "made", "us", "more", "confident", "that", "NETGEAR", "was", "not", "just", "serious", "about", "patching", "these", "vulnerabilities", ",", "but", "serious", "about", "changing", "how", "they", "handle", "third", "-", "party", "disclosure", "in", "general", ".", "We", "fully", "expect", "this", "move", "will", "not", "only", "smooth", "the", "relationship", "between", "third", "-", "party", "researchers", "and", "NETGEAR", ",", "but", ",", "in", "the", "end", ",", "will", "result", "in", "a", "more", "secure", "line", "of", "products", "and", "services", ".", "For", "starters", ",", "it", "affects", "a", "large", "number", "of", "models", ".", "We", "have", "found", "more", "than", "ten", "thousand", "vulnerable", "devices", "that", "are", "remotely", "accessible", ".", "The", "real", "number", "of", "affected", "devices", "is", "probably", "in", "the", "hundreds", "of", "thousands", ",", "if", "not", "over", "a", "million", ".", "The", "vulnerability", "can", "be", "used", "by", "a", "remote", "attacker", "if", "remote", "administration", "is", "set", "to", "be", "Internet", "facing", "."], "Event 1": {"trigger": {"start": 365, "end": 367, "text": ["found", "out"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 373, "end": 374, "text": ["unauth.cgi"]}, {"start": 375, "end": 383, "text": ["be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials"]}, {"start": 362, "end": 365, "text": ["Those", "two", "guys"]}], "Causal": [{"start": 373, "end": 374, "text": ["unauth.cgi"]}, {"start": 375, "end": 383, "text": ["be", "used", "with", "passwordrecovered.cgi", "to", "retrieve", "the", "credentials"]}, {"start": 362, "end": 365, "text": ["Those", "two", "guys"]}], "Effect": []}, "Event 2": {"trigger": {"start": 344, "end": 347, "text": ["2", "publicly", "disclosed"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 349, "end": 350, "text": ["2014"]}, {"start": 352, "end": 354, "text": ["different", "models"]}, {"start": 355, "end": 361, "text": ["manage", "to", "do", "unauthenticated", "password", "disclosure"]}, {"start": 334, "end": 338, "text": ["\"", "unauth.cgi", "\"", "page"]}], "Causal": [{"start": 355, "end": 361, "text": ["manage", "to", "do", "unauthenticated", "password", "disclosure"]}, {"start": 334, "end": 338, "text": ["\"", "unauth.cgi", "\"", "page"]}], "Effect": []}, "Event 3": {"trigger": {"start": 87, "end": 90, "text": ["want", "to", "share"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 86, "end": 87, "text": ["I"]}, {"start": 82, "end": 86, "text": ["the", "two", "NETGEAR", "vulnerabilities"]}, {"start": 92, "end": 93, "text": ["today"]}], "Causal": [{"start": 86, "end": 87, "text": ["I"]}, {"start": 82, "end": 86, "text": ["the", "two", "NETGEAR", "vulnerabilities"]}], "Effect": []}, "Event 4": {"trigger": {"start": 574, "end": 575, "text": ["found"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 570, "end": 572, "text": ["the", "issue"]}, {"start": 573, "end": 574, "text": ["I"]}, {"start": 581, "end": 587, "text": ["passwordrecovered.cgi", "will", "give", "out", "the", "credentials"]}], "Causal": [{"start": 570, "end": 572, "text": ["the", "issue"]}, {"start": 573, "end": 574, "text": ["I"]}, {"start": 581, "end": 587, "text": ["passwordrecovered.cgi", "will", "give", "out", "the", "credentials"]}], "Effect": []}, "Event 5": {"trigger": {"start": 619, "end": 620, "text": ["found"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 622, "end": 624, "text": ["second", "bug"]}, {"start": 609, "end": 610, "text": ["I"]}, {"start": 611, "end": 613, "text": ["both", "bugs"]}, {"start": 618, "end": 619, "text": ["I"]}, {"start": 631, "end": 632, "text": ["models"]}, {"start": 615, "end": 617, "text": ["NETGEAR", "models"]}], "Causal": [{"start": 622, "end": 624, "text": ["second", "bug"]}, {"start": 609, "end": 610, "text": ["I"]}, {"start": 611, "end": 613, "text": ["both", "bugs"]}, {"start": 618, "end": 619, "text": ["I"]}], "Effect": []}, "Event 6": {"trigger": {"start": 657, "end": 660, "text": ["have", "been", "assigned"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 655, "end": 657, "text": ["The", "vulnerabilities"]}, {"start": 660, "end": 662, "text": ["CVE", "-2017-5521"]}, {"start": 663, "end": 666, "text": ["TWSL2017", "-", "003"]}], "Causal": [{"start": 655, "end": 657, "text": ["The", "vulnerabilities"]}, {"start": 660, "end": 662, "text": ["CVE", "-2017-5521"]}, {"start": 663, "end": 666, "text": ["TWSL2017", "-", "003"]}], "Effect": []}, "Event 7": {"trigger": {"start": 693, "end": 695, "text": ["both", "findings"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 691, "end": 692, "text": ["we"]}, {"start": 696, "end": 697, "text": ["NETGEAR"]}, {"start": 701, "end": 703, "text": ["April", "2016"]}], "Causal": [{"start": 691, "end": 692, "text": ["we"]}, {"start": 696, "end": 697, "text": ["NETGEAR"]}], "Effect": []}, "Event 8": {"trigger": {"start": 715, "end": 718, "text": ["listed", "as", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 714, "end": 715, "text": ["models"]}, {"start": 726, "end": 728, "text": ["the", "vulnerability"]}, {"start": 730, "end": 732, "text": ["latest", "firmware"]}], "Causal": [{"start": 726, "end": 728, "text": ["the", "vulnerability"]}], "Effect": []}, "Event 9": {"trigger": {"start": 755, "end": 757, "text": ["were", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 750, "end": 751, "text": ["models"]}, {"start": 759, "end": 762, "text": ["latest", "firmware", "version"]}], "Causal": [], "Effect": []}, "Event 10": {"trigger": {"start": 832, "end": 835, "text": ["listed", "as", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 828, "end": 829, "text": ["models"]}], "Causal": [], "Effect": []}, "Event 11": {"trigger": {"start": 735, "end": 737, "text": ["was", "fixed"]}, "event_type": "PatchVulnerability", "argument": [{"start": 734, "end": 735, "text": ["it"]}, {"start": 740, "end": 744, "text": ["a", "different", "patch", "cycle"]}], "Causal": [], "Effect": []}, "Event 12": {"trigger": {"start": 770, "end": 771, "text": ["provided"]}, "event_type": "PatchVulnerability", "argument": [{"start": 765, "end": 766, "text": ["NETGEAR"]}, {"start": 764, "end": 765, "text": ["June"]}, {"start": 778, "end": 780, "text": ["vulnerable", "routers"]}, {"start": 771, "end": 773, "text": ["a", "fix"]}], "Causal": [{"start": 765, "end": 766, "text": ["NETGEAR"]}], "Effect": []}, "Event 13": {"trigger": {"start": 822, "end": 824, "text": ["are", "patched"]}, "event_type": "PatchVulnerability", "argument": [{"start": 817, "end": 818, "text": ["models"]}], "Causal": [], "Effect": []}, "Event 14": {"trigger": {"start": 901, "end": 903, "text": ["to", "patch"]}, "event_type": "PatchVulnerability", "argument": [{"start": 899, "end": 900, "text": ["them"]}, {"start": 891, "end": 892, "text": ["NETGEAR"]}, {"start": 903, "end": 905, "text": ["more", "models"]}], "Causal": [{"start": 899, "end": 900, "text": ["them"]}, {"start": 891, "end": 892, "text": ["NETGEAR"]}], "Effect": []}, "Event 15": {"trigger": {"start": 1037, "end": 1038, "text": ["patching"]}, "event_type": "PatchVulnerability", "argument": [{"start": 1031, "end": 1032, "text": ["NETGEAR"]}, {"start": 1038, "end": 1040, "text": ["these", "vulnerabilities"]}], "Causal": [{"start": 1031, "end": 1032, "text": ["NETGEAR"]}, {"start": 1038, "end": 1040, "text": ["these", "vulnerabilities"]}], "Effect": []}, "Event 16": {"trigger": {"start": 839, "end": 843, "text": ["listed", "as", "not", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [], "Causal": [], "Effect": []}, "Event 17": {"trigger": {"start": 855, "end": 859, "text": ["listed", "as", "not", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 854, "end": 855, "text": ["models"]}, {"start": 860, "end": 861, "text": ["DGN2200v4"]}], "Causal": [], "Effect": []}, "Event 18": {"trigger": {"start": 910, "end": 912, "text": ["have", "found"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 913, "end": 915, "text": ["vulnerable", "models"]}, {"start": 909, "end": 910, "text": ["we"]}], "Causal": [{"start": 909, "end": 910, "text": ["we"]}], "Effect": []}, "Event 19": {"trigger": {"start": 945, "end": 947, "text": ["was", "vulnerable"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 944, "end": 945, "text": ["it"]}], "Causal": [], "Effect": []}, "Event 20": {"trigger": {"start": 932, "end": 933, "text": ["discovered"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 934, "end": 938, "text": ["the", "Lenovo", "R3220", "router"]}, {"start": 941, "end": 943, "text": ["NETGEAR", "firmware"]}, {"start": 930, "end": 931, "text": ["We"]}], "Causal": [{"start": 930, "end": 931, "text": ["We"]}], "Effect": []}, "Event 21": {"trigger": {"start": 964, "end": 965, "text": ["disclose"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 965, "end": 967, "text": ["these", "vulnerabilities"]}, {"start": 960, "end": 961, "text": ["we"]}], "Causal": [{"start": 965, "end": 967, "text": ["these", "vulnerabilities"]}, {"start": 960, "end": 961, "text": ["we"]}], "Effect": []}, "Event 22": {"trigger": {"start": 992, "end": 994, "text": ["responsibly", "disclose"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 983, "end": 988, "text": ["third", "-", "party", "vulnerability", "researchers"]}, {"start": 995, "end": 996, "text": ["NETGEAR"]}], "Causal": [{"start": 983, "end": 988, "text": ["third", "-", "party", "vulnerability", "researchers"]}, {"start": 995, "end": 996, "text": ["NETGEAR"]}], "Effect": []}, "Event 23": {"trigger": {"start": 1104, "end": 1106, "text": ["have", "found"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 1103, "end": 1104, "text": ["We"]}, {"start": 1110, "end": 1112, "text": ["vulnerable", "devices"]}, {"start": 1114, "end": 1116, "text": ["remotely", "accessible"]}], "Causal": [{"start": 1103, "end": 1104, "text": ["We"]}, {"start": 1114, "end": 1116, "text": ["remotely", "accessible"]}], "Effect": []}}