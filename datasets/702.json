{"tokens": ["The", "problems", "arise", "from", "the", "way", "Java", "and", "Python", "(", "through", "the", "urllib2", "library", "in", "Python", "2", "and", "urllib", "library", "in", "Python", "3", ")", "handle", "FTP", "links", ",", "which", "allow", "the", "attacker", "to", "inject", "newline", "(", "CRLF", ")", "characters", "inside", "the", "URL", ",", "making", "the", "Java", "and", "Python", "code", "think", "some", "parts", "of", "the", "URL", "are", "new", "commands", ".", "This", "leads", "to", "a", "flaw", "that", "security", "researchers", "call", "\"", "protocol", "injection", ".", "\"", "The", "FTP", "protocol", "injection", "issue", "was", "first", "detailed", "by", "Russian", "security", "lab", "ONsec", "in", "2014", ",", "but", "never", "got", "the", "public", "attention", "it", "needed", ".", "Two", "recent", "reports", "have", "raised", "the", "profile", "of", "this", "flaw", ",", "describing", "two", "new", "exploitation", "scenarios", ".", "Security", "researcher", "Alexander", "Klink", "detailed", "on", "his", "blog", "how", "the", "FTP", "protocol", "injection", "flaw", "could", "be", "used", "to", "send", "emails", "using", "Java", "'s", "FTP", "URL", "handler", ".", "Two", "days", "later", ",", "Timothy", "Morgan", "of", "Blindspot", "Security", "came", "forward", "and", "presented", "a", "more", "ominious", "exploitation", "scenario", "where", "the", "FTP", "URL", "handlers", "in", "Java", "and", "Python", "could", "be", "used", "to", "bypass", "firewalls", ".", "Morgan", "also", "revealed", "that", "his", "company", "informed", "both", "the", "Python", "team", "(", "in", "January", "2016", ")", "and", "Oracle", "(", "in", "November", "2016", ")", "about", "the", "FTP", "protocol", "injection", "flaw", ",", "but", "neither", "have", "issued", "updates", "to", "address", "the", "reported", "problem", ".", "At", "the", "heart", "of", "the", "FTP", "protocol", "injection", "attack", "resides", "an", "older", "issue", "in", "the", "FTP", "protocol", "itself", ",", "which", "is", "classic", "mode", "FTP", ".", "The", "classic", "mode", "FTP", "is", "an", "older", "mechanism", "that", "governs", "how", "FTP", "clients", "and", "servers", "interact", ",", "which", "was", "proved", "to", "be", "insecure", "in", "issue", "#", "60", "of", "the", "Phrack", "hacking", "magazine", "and", "later", "detailed", "in", "more", "depth", "by", "Florian", "Weimer", ".", "Classic", "mode", "FTP", "has", "been", "replaced", "by", "a", "more", "secure", "method", "of", "client", "-", "server", "FTP", "interactions", "known", "as", "passive", "mode", "FTP", ".", "Nevertheless", ",", "most", "firewall", "products", "support", "classic", "mode", "FTP", "connections", "."], "entities": [{"type": "DiscoverVulnerability", "start": 2, "end": 4, "text": ["arise", "from"], "role": "trigger"}, {"type": "System", "start": 6, "end": 7, "text": ["Java"], "role": "Vulnerable_System"}, {"type": "System", "start": 8, "end": 9, "text": ["Python"], "role": "Vulnerable_System"}, {"type": "Vulnerability", "start": 0, "end": 2, "text": ["The", "problems"], "role": "Vulnerability"}, {"type": "Capabilities", "start": 29, "end": 42, "text": ["allow", "the", "attacker", "to", "inject", "newline", "(", "CRLF", ")", "characters", "inside", "the", "URL"], "role": "Capabilities"}, {"type": "System", "start": 12, "end": 14, "text": ["urllib2", "library"], "role": "Vulnerable_System"}, {"type": "System", "start": 15, "end": 17, "text": ["Python", "2"], "role": "Vulnerable_System"}, {"type": "System", "start": 18, "end": 20, "text": ["urllib", "library"], "role": "Vulnerable_System"}, {"type": "System", "start": 21, "end": 23, "text": ["Python", "3"], "role": "Vulnerable_System"}, {"type": "DiscoverVulnerability", "start": 67, "end": 68, "text": ["call"], "role": "trigger"}, {"type": "Vulnerability", "start": 69, "end": 71, "text": ["protocol", "injection"], "role": "Vulnerability"}, {"type": "Person", "start": 65, "end": 67, "text": ["security", "researchers"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 62, "end": 64, "text": ["a", "flaw"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 78, "end": 81, "text": ["was", "first", "detailed"], "role": "trigger"}, {"type": "Organization", "start": 82, "end": 86, "text": ["Russian", "security", "lab", "ONsec"], "role": "Discoverer"}, {"type": "Time", "start": 87, "end": 88, "text": ["2014"], "role": "Time"}, {"type": "Vulnerability", "start": 73, "end": 78, "text": ["The", "FTP", "protocol", "injection", "issue"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 101, "end": 103, "text": ["have", "raised"], "role": "trigger"}, {"type": "Vulnerability", "start": 107, "end": 108, "text": ["flaw"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 98, "end": 101, "text": ["Two", "recent", "reports"], "role": "trigger"}, {"type": "DiscoverVulnerability", "start": 119, "end": 120, "text": ["detailed"], "role": "trigger"}, {"type": "Capabilities", "start": 130, "end": 141, "text": ["be", "used", "to", "send", "emails", "using", "Java", "'s", "FTP", "URL", "handler"], "role": "Capabilities"}, {"type": "Vulnerability", "start": 124, "end": 129, "text": ["the", "FTP", "protocol", "injection", "flaw"], "role": "Vulnerability"}, {"type": "Person", "start": 115, "end": 119, "text": ["Security", "researcher", "Alexander", "Klink"], "role": "Discoverer"}, {"type": "DiscoverVulnerability", "start": 154, "end": 155, "text": ["presented"], "role": "trigger"}, {"type": "Person", "start": 146, "end": 148, "text": ["Timothy", "Morgan"], "role": "Discoverer"}, {"type": "Time", "start": 142, "end": 145, "text": ["Two", "days", "later"], "role": "Time"}, {"type": "Vulnerability", "start": 155, "end": 160, "text": ["a", "more", "ominious", "exploitation", "scenario"], "role": "Vulnerability"}, {"type": "System", "start": 161, "end": 165, "text": ["the", "FTP", "URL", "handlers"], "role": "Vulnerable_System"}, {"type": "System", "start": 166, "end": 167, "text": ["Java"], "role": "Vulnerable_System"}, {"type": "System", "start": 168, "end": 169, "text": ["Python"], "role": "Vulnerable_System"}, {"type": "Capabilities", "start": 170, "end": 175, "text": ["be", "used", "to", "bypass", "firewalls"], "role": "Capabilities"}, {"type": "DiscoverVulnerability", "start": 178, "end": 179, "text": ["revealed"], "role": "trigger"}, {"type": "Person", "start": 176, "end": 177, "text": ["Morgan"], "role": "Discoverer"}, {"type": "DiscoverVulnerability", "start": 182, "end": 183, "text": ["informed"], "role": "trigger"}, {"type": "Organization", "start": 180, "end": 182, "text": ["his", "company"], "role": "Discoverer"}, {"type": "Person", "start": 184, "end": 187, "text": ["the", "Python", "team"], "role": "Vulnerable_System_Owner"}, {"type": "Time", "start": 189, "end": 191, "text": ["January", "2016"], "role": "Time"}, {"type": "Organization", "start": 193, "end": 194, "text": ["Oracle"], "role": "Vulnerable_System_Owner"}, {"type": "Time", "start": 196, "end": 198, "text": ["November", "2016"], "role": "Time"}, {"type": "Vulnerability", "start": 200, "end": 205, "text": ["the", "FTP", "protocol", "injection", "flaw"], "role": "Vulnerability"}, {"type": "PatchVulnerability", "start": 212, "end": 213, "text": ["address"], "role": "trigger"}, {"type": "Patch", "start": 209, "end": 211, "text": ["issued", "updates"], "role": "Patch"}, {"type": "Vulnerability", "start": 213, "end": 216, "text": ["the", "reported", "problem"], "role": "Vulnerability"}], "relations": [{"type": "Causal", "head": 3, "tail": 0}, {"type": "Causal", "head": 4, "tail": 0}, {"type": "Causal", "head": 10, "tail": 9}, {"type": "Causal", "head": 11, "tail": 9}, {"type": "Causal", "head": 12, "tail": 9}, {"type": "Causal", "head": 14, "tail": 13}, {"type": "Causal", "head": 16, "tail": 13}, {"type": "Causal", "head": 18, "tail": 17}, {"type": "Causal", "head": 21, "tail": 20}, {"type": "Causal", "head": 22, "tail": 20}, {"type": "Causal", "head": 23, "tail": 20}, {"type": "Causal", "head": 25, "tail": 24}, {"type": "Causal", "head": 27, "tail": 24}, {"type": "Causal", "head": 31, "tail": 24}, {"type": "Causal", "head": 33, "tail": 32}, {"type": "Causal", "head": 35, "tail": 34}, {"type": "Causal", "head": 40, "tail": 34}, {"type": "Causal", "head": 43, "tail": 41}], "POS": ["DT", "NNS", "VBP", "IN", "DT", "NN", "NNP", "CC", "NNP", "(", "IN", "DT", "JJ", "NN", "IN", "NNP", "CD", "CC", "JJ", "NN", "IN", "NNP", "CD", ")", "NN", "NNP", "NNS", ",", "WDT", "VBP", "DT", "NN", "TO", "VB", "NN", "(", "NNP", ")", "NNS", "IN", "DT", "NNP", ",", "VBG", "DT", "NNP", "CC", "NNP", "NN", "VBP", "DT", "NNS", "IN", "DT", "NNP", "VBP", "JJ", "NNS", ".", "DT", "VBZ", "TO", "DT", "NN", "WDT", "NN", "NNS", "VBP", "NNP", "NN", "NN", ".", "VB", "DT", "NNP", "NN", "NN", "NN", "VBD", "RB", "VBN", "IN", "JJ", "NN", "NN", "NNP", "IN", "CD", ",", "CC", "RB", "VBD", "DT", "JJ", "NN", "PRP", "VBD", ".", "CD", "JJ", "NNS", "VBP", "VBN", "DT", "NN", "IN", "DT", "NN", ",", "VBG", "CD", "JJ", "NN", "NNS", ".", "NNP", "NN", "NNP", "NNP", "VBD", "IN", "PRP$", "NN", "WRB", "DT", "NNP", "NN", "NN", "NN", "MD", "VB", "VBN", "TO", "VB", "NNS", "VBG", "NNP", "POS", "NNP", "NNP", "NN", ".", "CD", "NNS", "RB", ",", "NNP", "NNP", "IN", "NNP", "NNP", "VBD", "RB", "CC", "VBD", "DT", "RBR", "JJ", "NN", "NN", "WRB", "DT", "NNP", "NNP", "NNS", "IN", "NNP", "CC", "NNP", "MD", "VB", "VBN", "TO", "VB", "NNS", ".", "NNP", "RB", "VBD", "IN", "PRP$", "NN", "VBD", "DT", "DT", "NNP", "NN", "(", "IN", "NNP", "CD", ")", "CC", "NNP", "(", "IN", "NNP", "CD", ")", "IN", "DT", "NNP", "NN", "NN", "NN", ",", "CC", "DT", "VBP", "VBN", "NNS", "TO", "VB", "DT", "VBN", "NN", ".", "IN", "DT", "NN", "IN", "DT", "NNP", "NN", "NN", "NN", "VBZ", "DT", "JJR", "NN", "IN", "DT", "NNP", "NN", "PRP", ",", "WDT", "VBZ", "JJ", "NN", "NNP", ".", "DT", "JJ", "NN", "NNP", "VBZ", "DT", "JJR", "NN", "IN", "VBZ", "WRB", "JJ", "NNS", "CC", "NNS", "VBP", ",", "WDT", "VBD", "VBN", "TO", "VB", "NN", "IN", "NN", "#", "CD", "IN", "DT", "NNP", "VBG", "NN", "CC", "RB", "VBN", "IN", "RBR", "NN", "IN", "JJ", "NNP", ".", "JJ", "NN", "NNP", "VBZ", "VBN", "VBN", "IN", "DT", "RBR", "JJ", "NN", "IN", "NN", ":", "NN", "NNP", "NNS", "VBN", "IN", "JJ", "NN", "NNP", ".", "NNP", ",", "JJS", "JJ", "NNS", "NN", "JJ", "NN", "NNP", "NNS", "."]}