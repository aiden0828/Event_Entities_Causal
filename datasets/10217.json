{"tokens": ["Valve", "has", "patched", "a", "critical", "vulnerability", "in", "the", "Steam", "client", "which", "has", "lurked", "undetected", "for", "at", "least", "10", "years", ".", "The", "vulnerability", "impacts", "all", "versions", "of", "the", "gaming", "platform", ".", "Tom", "Court", ",", "a", "security", "researcher", "hailing", "from", "Context", "Information", "Security", ",", "discovered", "the", "bug", "and", "disclosed", "his", "findings", "on", "Thursday", ".", "In", "a", "blog", "post", ",", "the", "researcher", "said", "that", "left", "unpatched", ",", "the", "bug", "permits", "threat", "actors", "to", "perform", "remote", "code", "execution", "(", "RCE", ")", "attacks", ".", "It", "was", "not", "until", "July", "last", "year", "that", "Valve", "added", "modern", "ASLR", "exploit", "protections", "to", "its", "Steam", "source", "code", ".", "However", ",", "this", "addition", "made", "sure", "that", "the", "vulnerability", "would", "only", "cause", "a", "client", "crash", "if", "exploited", "--", "unless", "a", "separate", "information", "leak", "vulnerability", "was", "also", "active", "in", "the", "exploit", "chain", ".", "Valve", "'s", "Steam", "software", "uses", "a", "custom", "protocol", ",", "known", "as", "the", "\"", "Steam", "Protocol", ",", "\"", "which", "is", "delivered", "on", "the", "top", "of", "UDP", ".", "The", "protocol", "registers", "packet", "length", "and", "the", "total", "reassembled", "datagram", "length", ";", "however", ",", "the", "vulnerability", "was", "caused", "by", "a", "simple", "lack", "of", "checks", "to", "ensure", "that", "for", "the", "first", "packet", "of", "a", "fragmented", "datagram", ",", "the", "specified", "length", "was", "less", "than", "or", "equal", "to", "the", "total", "datagram", "length", ".", "All", "an", "attacker", "needed", "to", "do", "was", "to", "send", "a", "malformed", "UDP", "packet", "to", "trigger", "the", "exploit", ".", "\"", "This", "means", "that", "it", "is", "possible", "to", "supply", "a", "data_len", "smaller", "than", "packet_len", "and", "have", "up", "to", "64kb", "of", "data", "(", "due", "to", "the", "2", "-", "byte", "width", "of", "the", "packet_len", "field", ")", "copied", "to", "a", "very", "small", "buffer", ",", "resulting", "in", "an", "exploitable", "heap", "corruption", ",", "\"", "Court", "says", ".", "\"", "This", "seems", "like", "a", "simple", "oversight", ",", "given", "that", "the", "check", "was", "present", "for", "all", "subsequent", "packets", "carrying", "fragments", "of", "the", "datagram", ".", "\"", "The", "vulnerability", "was", "reported", "to", "Valve", "on", "20", "February", "and", "was", "fixed", "in", "a", "beta", "release", "less", "than", "12", "hours", "later", ".", "This", "patch", "was", "then", "pushed", "to", "a", "stable", "release", "on", "22", "March", ".", "\"", "This", "was", "a", "very", "simple", "bug", ",", "made", "relatively", "straightforward", "to", "exploit", "due", "to", "a", "lack", "of", "modern", "exploit", "protections", ",", "\"", "Court", "says", ".", "\"", "The", "vulnerable", "code", "was", "probably", "very", "old", ",", "but", "as", "it", "was", "otherwise", "in", "good", "working", "order", ",", "the", "developers", "likely", "saw", "no", "reason", "to", "go", "near", "it", "or", "update", "their", "build", "scripts", ".", "\"", "\"", "The", "lesson", "here", "is", "that", "as", "a", "developer", "it", "is", "important", "to", "periodically", "include", "aging", "code", "and", "build", "systems", "in", "your", "reviews", "to", "ensure", "they", "conform", "to", "modern", "security", "standards", ",", "even", "if", "the", "actual", "functionality", "of", "the", "code", "has", "remained", "unchanged", ",", "\"", "the", "researcher", "added", "."], "Event 1": {"trigger": {"start": 22, "end": 23, "text": ["impacts"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 20, "end": 22, "text": ["The", "vulnerability"]}, {"start": 26, "end": 29, "text": ["the", "gaming", "platform"]}, {"start": 23, "end": 25, "text": ["all", "versions"]}], "Causal": [{"start": 20, "end": 22, "text": ["The", "vulnerability"]}], "Effect": []}, "Event 2": {"trigger": {"start": 42, "end": 43, "text": ["discovered"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 38, "end": 41, "text": ["Context", "Information", "Security"]}, {"start": 33, "end": 36, "text": ["a", "security", "researcher"]}, {"start": 30, "end": 32, "text": ["Tom", "Court"]}], "Causal": [{"start": 38, "end": 41, "text": ["Context", "Information", "Security"]}, {"start": 33, "end": 36, "text": ["a", "security", "researcher"]}, {"start": 30, "end": 32, "text": ["Tom", "Court"]}], "Effect": []}, "Event 3": {"trigger": {"start": 46, "end": 47, "text": ["disclosed"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 43, "end": 45, "text": ["the", "bug"]}, {"start": 47, "end": 49, "text": ["his", "findings"]}, {"start": 50, "end": 51, "text": ["Thursday"]}], "Causal": [{"start": 43, "end": 45, "text": ["the", "bug"]}, {"start": 47, "end": 49, "text": ["his", "findings"]}], "Effect": []}, "Event 4": {"trigger": {"start": 59, "end": 60, "text": ["said"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 64, "end": 66, "text": ["the", "bug"]}, {"start": 57, "end": 59, "text": ["the", "researcher"]}, {"start": 70, "end": 78, "text": ["perform", "remote", "code", "execution", "(", "RCE", ")", "attacks"]}], "Causal": [{"start": 64, "end": 66, "text": ["the", "bug"]}, {"start": 57, "end": 59, "text": ["the", "researcher"]}, {"start": 70, "end": 78, "text": ["perform", "remote", "code", "execution", "(", "RCE", ")", "attacks"]}], "Effect": []}, "Event 5": {"trigger": {"start": 115, "end": 116, "text": ["exploited"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 107, "end": 108, "text": ["vulnerability"]}, {"start": 110, "end": 114, "text": ["cause", "a", "client", "crash"]}], "Causal": [{"start": 107, "end": 108, "text": ["vulnerability"]}, {"start": 110, "end": 114, "text": ["cause", "a", "client", "crash"]}], "Effect": []}, "Event 6": {"trigger": {"start": 304, "end": 306, "text": ["was", "reported"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 307, "end": 308, "text": ["Valve"]}, {"start": 309, "end": 311, "text": ["20", "February"]}, {"start": 302, "end": 304, "text": ["The", "vulnerability"]}], "Causal": [{"start": 302, "end": 304, "text": ["The", "vulnerability"]}], "Effect": []}, "Event 7": {"trigger": {"start": 326, "end": 329, "text": ["was", "then", "pushed"]}, "event_type": "PatchVulnerability", "argument": [{"start": 330, "end": 333, "text": ["a", "stable", "release"]}, {"start": 334, "end": 336, "text": ["22", "March"]}, {"start": 324, "end": 326, "text": ["This", "patch"]}], "Causal": [], "Effect": []}, "Event 8": {"trigger": {"start": 312, "end": 314, "text": ["was", "fixed"]}, "event_type": "PatchVulnerability", "argument": [{"start": 315, "end": 318, "text": ["a", "beta", "release"]}, {"start": 320, "end": 323, "text": ["12", "hours", "later"]}], "Causal": [], "Effect": []}, "Event 9": {"trigger": {"start": 61, "end": 63, "text": ["left", "unpatched"]}, "event_type": "PatchVulnerability", "argument": [], "Causal": [], "Effect": []}, "Event 10": {"trigger": {"start": 1, "end": 3, "text": ["has", "patched"]}, "event_type": "PatchVulnerability", "argument": [{"start": 3, "end": 6, "text": ["a", "critical", "vulnerability"]}, {"start": 0, "end": 1, "text": ["Valve"]}, {"start": 7, "end": 10, "text": ["the", "Steam", "client"]}], "Causal": [{"start": 3, "end": 6, "text": ["a", "critical", "vulnerability"]}, {"start": 0, "end": 1, "text": ["Valve"]}], "Effect": []}}