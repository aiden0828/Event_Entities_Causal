{"tokens": ["I", "recently", "had", "a", "client", "get", "an", "interesting", "phishing", "message", ".", "They", "had", "received", "a", "fake", "message", "from", "their", "CEO", "to", "their", "Controller", "-", "a", "\"", "start", "the", "conversation", "\"", "email", "to", "end", "up", "with", "a", "wire", "transfer", ".", "This", "sort", "of", "email", "is", "not", "common", ",", "but", "is", "frequent", "enough", "in", "Sr", "Management", "circles", ",", "especially", "if", "you", "are", "in", "the", "middle", "of", "merger", "or", "acquisition", "discussions", "with", "another", "company", ".", "Some", "technical", "warning", "signs", "in", "that", "note", "were", ":", "So", "the", "discussion", "quickly", "moved", "from", "\"", "I", "'m", "glad", "our", "execs", "came", "to", "us", ",", "we", "really", "dodged", "a", "bullet", "there", "\"", "to", "\"", "just", "how", "did", "this", "get", "in", "the", "door", "past", "our", "spam", "filter", "anyway", "?", "\"", "Their", "SPAM", "filter", "does", "use", "the", "SPF", "(", "Sender", "Policy", "Framework", ")", "DNS", "TXT", "record", ",", "and", "a", "quick", "check", "on", "the", "SPF", "indicated", "that", "things", "looked", "in", "order", "there", ".", "However", ",", "after", "a", "second", "look", ",", "the", "problem", "jumped", "right", "out", ".", "A", "properly", "formed", "SPF", "will", "end", "with", "a", "\"", "-", "\"", ",", "which", "essentially", "means", "\"", "mail", "senders", "in", "this", "SPF", "record", "are", "valid", "for", "this", "domain", ",", "and", "no", "others", "\"", ".", "However", ",", "their", "SPF", "had", "a", "typo", "-", "their", "record", "ended", "in", "a", "\"", "~", "\"", "instead", ".", "What", "the", "tilde", "character", "means", "to", "this", "spam", "filter", "is", "\"", "the", "mail", "senders", "in", "this", "SPF", "record", "are", "valid", "for", "this", "domain", ",", "but", "YOLO", ",", "so", "is", "any", "other", "mail", "sender", "\"", ".", "From", "the", "RFC", "(", "RFC7208", ")", ",", "the", "~", "means", "\"", "softfail", "\"", ",", "\"", "A", "\"", "softfail", "\"", "result", "is", "a", "weak", "statement", "by", "the", "publishing", "ADMD", "that", "the", "host", "is", "probably", "not", "authorized", "\"", ".", "More", "detail", "appears", "later", "in", "the", "RFC", ":", "\"", "A", "\"", "softfail", "\"", "result", "ought", "to", "be", "treated", "as", "somewhere", "between", "\"", "fail", "\"", "and", "\"", "neutral", "\"", "/", "\"", "none", "\"", ".", "The", "ADMD", "believes", "the", "host", "is", "not", "authorized", "but", "is", "not", "willing", "to", "make", "a", "strong", "policy", "statement", ".", "Receiving", "software", "SHOULD", "NOT", "reject", "the", "message", "based", "solely", "on", "this", "result", ",", "but", "MAY", "subject", "the", "message", "to", "closer", "scrutiny", "than", "normal", ".", "\"", "This", "same", "reasoning", "applies", "to", "the", "~", "all", "and", "-", "all", "directives", "in", "the", "SPF", "(", "which", "I", "see", "more", "often", ")", ".", "You", "'d", "think", "that", "a", "lot", "has", "changed", "since", "2006", "(", "the", "date", "of", "the", "original", "SPF", "spec", ",", "RFC4408", ")", ",", "that", "in", "2017", "a", "spam", "filter", "should", "fail", "on", "that", "result", ",", "but", "apparently", "not", "(", "sad", "panda", ")", ".", "Kinda", "makes", "you", "wonder", "what", "the", "actual", "use", "case", "is", "for", "that", "tilde", "character", "in", "the", "definition", "-", "I", "ca", "n't", "think", "of", "a", "good", "reason", "to", "list", "permitted", "mail", "senders", ",", "then", "allow", "any", "and", "every", "other", "server", "too", ".", "That", "being", "said", ",", "their", "filter", "*", "should", "*", "still", "have", "caught", "the", "mismatch", "between", "the", "\"", "from", "\"", "and", "\"", "reply", "-", "to", "\"", "fields", ",", "especially", "since", "it", "involved", "an", "external", "source", "and", "internal", "domains", ".", "Or", "at", "least", "paired", "that", "up", "with", "the", "domain", "mismatch", "to", "weight", "this", "email", "towards", "a", "SPAM", "decision", ".", "Long", "story", "short", "-", "this", "type", "of", "attack", "was", "pretty", "popular", "(", "and", "widely", "reported", ")", "about", "a", "year", "ago", ",", "but", "successful", "methods", "never", "(", "never", "ever", ")", "go", "away", ".", "A", "little", "bit", "of", "research", "can", "make", "for", "a", "really", "well", "-", "formed", "phish", ",", "right", "down", "to", "using", "the", "right", "people", "in", "the", "conversation", ",", "good", "grammar", ",", "and", "phrasing", "appropriate", "to", "the", "people", "involved", ".", "So", "a", "bit", "of", "homework", "can", "get", "an", "attacker", "a", "really", "nice", "payday", ",", "especially", "if", "their", "campaign", "targets", "a", "few", "hundred", "companies", "at", "a", "time", "(", "and", "they", "put", "more", "work", "into", "their", "email", "than", "the", "example", "above", ")", "So", "in", "this", "case", ",", "a", "typo", "in", "a", "DNS", "record", "could", "have", "cost", "millions", "of", "dollars", ".", "Good", "security", "training", "for", "the", "end", "users", "and", "vigilant", "people", "made", "all", "the", "difference", "-", "a", "phone", "call", "to", "confirm", "is", "a", "\"", "must", "-", "do", "\"", "step", "before", "doing", "something", "irrevocable", "like", "a", "wire", "transfer"], "entities": [{"type": "Phishing", "start": 5, "end": 6, "text": ["get"], "role": "trigger"}, {"type": "File", "start": 6, "end": 10, "text": ["an", "interesting", "phishing", "message"], "role": "Tool"}, {"type": "Person", "start": 3, "end": 5, "text": ["a", "client"], "role": "Victim"}, {"type": "Phishing", "start": 12, "end": 14, "text": ["had", "received"], "role": "trigger"}, {"type": "File", "start": 14, "end": 17, "text": ["a", "fake", "message"], "role": "Tool"}, {"type": "Person", "start": 18, "end": 20, "text": ["their", "CEO"], "role": "Trusted-Entity"}, {"type": "Person", "start": 11, "end": 12, "text": ["They"], "role": "Victim"}, {"type": "Purpose", "start": 32, "end": 38, "text": ["end", "up", "with", "a", "wire", "transfer"], "role": "Purpose"}], "relations": [{"type": "Effect", "head": 0, "tail": 2}, {"type": "Effect", "head": 3, "tail": 6}, {"type": "Causal", "head": 7, "tail": 3}], "POS": ["PRP", "RB", "VBD", "DT", "NN", "VB", "DT", "JJ", "NN", "NN", ".", "PRP", "VBD", "VBN", "DT", "JJ", "NN", "IN", "PRP$", "NN", "TO", "PRP$", "NNP", ":", "DT", "JJ", "NN", "DT", "NN", "NNP", "NN", "TO", "VB", "RP", "IN", "DT", "NN", "NN", ".", "DT", "NN", "IN", "NN", "VBZ", "RB", "JJ", ",", "CC", "VBZ", "JJ", "RB", "IN", "NNP", "NNP", "NNS", ",", "RB", "IN", "PRP", "VBP", "IN", "DT", "NN", "IN", "NN", "CC", "NN", "NNS", "IN", "DT", "NN", ".", "DT", "JJ", "NN", "NNS", "IN", "DT", "NN", "VBD", ":", "RB", "DT", "NN", "RB", "VBD", "IN", "NN", "PRP", "VBP", "JJ", "PRP$", "NN", "VBD", "TO", "PRP", ",", "PRP", "RB", "VBD", "DT", "NN", "RB", "VBZ", "TO", "VB", "RB", "WRB", "VBD", "DT", "NN", "IN", "DT", "NN", "IN", "PRP$", "NN", "NN", "RB", ".", "VB", "PRP$", "NNP", "NN", "VBZ", "VB", "DT", "NNP", "(", "NNP", "NNP", "NNP", ")", "NNP", "NNP", "NN", ",", "CC", "DT", "JJ", "NN", "IN", "DT", "NNP", "VBD", "IN", "NNS", "VBD", "IN", "NN", "RB", ".", "RB", ",", "IN", "DT", "JJ", "NN", ",", "DT", "NN", "VBD", "RB", "RP", ".", "DT", "RB", "VBN", "NNP", "MD", "VB", "IN", "DT", "JJ", ":", "NN", ",", "WDT", "RB", "VBZ", "JJ", "NN", "NNS", "IN", "DT", "NNP", "NN", "VBP", "JJ", "IN", "DT", "NN", ",", "CC", "DT", "NNS", "VBP", ".", "RB", ",", "PRP$", "NNP", "VBD", "DT", "JJ", ":", "PRP$", "NN", "VBN", "IN", "DT", "JJ", "NNP", "NNP", "RB", ".", "WP", "DT", "JJ", "NN", "VBZ", "TO", "DT", "NN", "NN", "VBZ", "PDT", "DT", "NN", "NNS", "IN", "DT", "NNP", "NN", "VBP", "JJ", "IN", "DT", "NN", ",", "CC", "NNP", ",", "RB", "VBZ", "DT", "JJ", "NN", "NN", "NNP", ".", "IN", "DT", "NNP", "(", "NNP", ")", ",", "DT", "NN", "VBZ", "JJ", "NN", "NN", ",", "VB", "NNP", "NNP", "NN", "NNP", "NN", "VBZ", "DT", "JJ", "NN", "IN", "DT", "NN", "NNP", "IN", "DT", "NN", "VBZ", "RB", "RB", "VBN", "NN", ".", "JJR", "NN", "VBZ", "RB", "IN", "DT", "NNP", ":", "VB", "DT", "JJ", "NN", "NNP", "NN", "MD", "TO", "VB", "VBN", "IN", "RB", "IN", "NNP", "VBP", "NN", "CC", "JJ", "JJ", "NNP", "NNP", "NNP", "NN", "NN", ".", "DT", "NNP", "VBZ", "DT", "NN", "VBZ", "RB", "VBN", "CC", "VBZ", "RB", "JJ", "TO", "VB", "DT", "JJ", "NN", "NN", ".", "VBG", "NN", "NNP", "NNP", "VB", "DT", "NN", "VBN", "RB", "IN", "DT", "NN", ",", "CC", "NNP", "VB", "DT", "NN", "TO", "JJR", "NN", "IN", "JJ", ".", "VB", "DT", "JJ", "VBG", "NNS", "TO", "DT", "NNP", "DT", "CC", ":", "DT", "NNS", "IN", "DT", "NNP", "(", "WDT", "PRP", "VBP", "RBR", "RB", ")", ".", "PRP", "MD", "VB", "IN", "DT", "NN", "VBZ", "VBN", "IN", "CD", "(", "DT", "NN", "IN", "DT", "JJ", "NNP", "NN", ",", "NNP", ")", ",", "IN", "IN", "CD", "DT", "JJ", "NN", "MD", "VB", "IN", "DT", "NN", ",", "CC", "RB", "RB", "(", "JJ", "NN", ")", ".", "NNP", "VBZ", "PRP", "VB", "WP", "DT", "JJ", "NN", "NN", "VBZ", "IN", "DT", "JJ", "NN", "IN", "DT", "NN", ":", "PRP", "MD", "RB", "VB", "IN", "DT", "JJ", "NN", "TO", "VB", "JJ", "NN", "NNS", ",", "RB", "VB", "DT", "CC", "DT", "JJ", "NN", "RB", ".", "IN", "VBG", "VBD", ",", "PRP$", "NN", "NN", "MD", "VB", "RB", "VB", "VBN", "DT", "NN", "IN", "DT", "NN", "IN", "NN", "CC", "NNP", "VBP", ":", "TO", "VB", "NNS", ",", "RB", "IN", "PRP", "VBD", "DT", "JJ", "NN", "CC", "JJ", "NNS", ".", "CC", "IN", "JJS", "VBD", "IN", "IN", "IN", "DT", "NN", "NN", "TO", "VB", "DT", "NN", "VBZ", "DT", "NNP", "NN", ".", "NNP", "NN", "JJ", ":", "DT", "NN", "IN", "NN", "VBD", "RB", "JJ", "(", "CC", "RB", "VBN", ")", "IN", "DT", "NN", "RB", ",", "CC", "JJ", "NNS", "RB", "(", "RB", "RB", ")", "VB", "RB", ".", "DT", "JJ", "NN", "IN", "NN", "MD", "VB", "IN", "DT", "RB", "RB", ":", "VBN", "JJ", ",", "RB", "RB", "TO", "VBG", "DT", "JJ", "NNS", "IN", "DT", "NN", ",", "JJ", "NN", ",", "CC", "VBG", "JJ", "TO", "DT", "NNS", "VBN", ".", "RB", "DT", "NN", "IN", "NN", "MD", "VB", "DT", "NN", "DT", "RB", "JJ", "NN", ",", "RB", "IN", "PRP$", "NN", "VBZ", "DT", "JJ", "JJ", "NNS", "IN", "DT", "NN", "(", "CC", "PRP", "VBD", "JJR", "NN", "IN", "PRP$", "NN", "IN", "DT", "NN", "IN", ")", "RB", "IN", "DT", "NN", ",", "DT", "NN", "IN", "DT", "NNP", "NN", "MD", "VB", "VBN", "NNS", "IN", "NNS", ".", "JJ", "NN", "NN", "IN", "DT", "NN", "NNS", "CC", "JJ", "NNS", "VBN", "PDT", "DT", "NN", ":", "DT", "NN", "NN", "TO", "VB", "VBZ", "DT", "NN", "MD", ":", "VB", "JJ", "NN", "IN", "VBG", "NN", "JJ", "IN", "DT", "NN", "NN"]}