{"tokens": ["Security", "researchers", "at", "Qualys", "Security", "have", "discovered", "a", "Linux", "flaw", "that", "could", "be", "exploited", "to", "gain", "root", "privileges", "and", "overwrite", "any", "file", "on", "the", "filesystem", "on", "SELinux", "-", "enabled", "systems", ".", "The", "high", "severity", "flaw", ",", "tracked", "as", "CVE", "-2017-1000367", ",", "resides", "in", "the", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", "and", "is", "related", "to", "the", "way", "Sudo", "parses", "tty", "information", "from", "the", "process", "status", "file", "in", "the", "proc", "filesystem", ".", "The", "Linux", "flaw", "could", "be", "exploited", "by", "a", "local", "user", "with", "privileges", "to", "execute", "commands", "via", "Sudo", "and", "could", "allow", "attackers", "to", "escalate", "their", "privileges", "to", "root", ".", "The", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "These", "fields", "are", "space", "-", "separated", ",", "the", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", ".", "Sudoer", "users", "on", "SELinux", "-", "enabled", "systems", "could", "escalate", "their", "privileges", "to", "overwrite", "any", "file", "on", "the", "filesystem", "with", "their", "command", "\u2019s", "output", ",", "including", "root", "-", "owned", "files", ".", "\u201c", "We", "discovered", "a", "vulnerability", "in", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", ":", "this", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "Unfortunately", ",", "these", "fields", "are", "space", "-", "separated", "and", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", "(", "CVE", "-2017-1000367", ")", ".", "\u201d", "reads", "the", "security", "advisory", ".", "\u201c", "On", "an", "SELinux", "-", "enabled", "system", ",", "if", "a", "user", "is", "Sudoer", "for", "a", "command", "that", "does", "not", "grant", "him", "full", "root", "privileges", ",", "he", "can", "overwrite", "any", "file", "on", "the", "filesystem", "(", "including", "root", "-", "owned", "files", ")", "with", "his", "command", "\u2019s", "output", ",", "because", "relabel_tty", "(", ")", "(", "in", "src/selinux.c", ")", "calls", "open", "(", "O_RDWR", "|", "O_NONBLOCK", ")", "on", "his", "tty", "and", "dup2", "(", ")", "s", "it", "to", "the", "command", "\u2019s", "stdin", ",", "stdout", ",", "and", "stderr", ".", "This", "allows", "any", "Sudoer", "user", "to", "obtain", "full", "root", "privileges", ".", "\u201d", "To", "exploit", "the", "issue", ",", "a", "Sudo", "user", "would", "have", "to", "choose", "a", "device", "number", "that", "does", "n\u2019t", "exist", "under", "\u201c", "/", "dev", "\u201d", ".", "If", "the", "terminal", "is", "n\u2019t", "present", "under", "the", "/", "dev", "/", "pts", "directory", "when", "the", "Sudo", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ",", "the", "user", "could", "allocate", "a", "pseudo-terminal", "between", "the", "two", "searchers", "and", "create", "a", "\u201c", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ",", "\u201d", "\u201c", "Exploiting", "the", "bug", "requires", "that", "the", "user", "already", "have", "sudo", "privileges", ".", "SELinux", "must", "also", "be", "enabled", "on", "the", "system", "and", "sudo", "must", "have", "been", "built", "with", "SELinux", "support", ".", "To", "exploit", "the", "bug", ",", "the", "user", "can", "choose", "a", "device", "number", "that", "does", "not", "currently", "exist", "under", "/", "dev", ".", "If", "sudo", "does", "not", "find", "the", "terminal", "under", "the", "/", "dev", "/", "pts", "directory", ",", "it", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ".", "It", "is", "possible", "to", "allocate", "a", "pseudo-terminal", "after", "sudo", "has", "checked", "/", "dev", "/", "pts", "but", "before", "sudo", "performs", "its", "breadth", "-", "first", "search", "of", "/", "dev", ".", "The", "attacker", "may", "then", "create", "a", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ".", "\u201d", "read", "a", "Sudo", "alert", ".", "\u201c", "This", "file", "will", "be", "used", "as", "the", "command", "\u2019s", "standard", "input", ",", "output", "and", "error", "when", "an", "SELinux", "role", "is", "specified", "on", "the", "sudo", "command", "line", ".", "If", "the", "symbolic", "link", "under", "/", "dev", "/", "shm", "is", "replaced", "with", "a", "link", "to", "an", "another", "file", "before", "it", "is", "opened", "by", "sudo", ",", "it", "is", "possible", "to", "overwrite", "an", "arbitrary", "file", "by", "writing", "to", "the", "standard", "output", "or", "standard", "error", ".", "This", "can", "be", "escalated", "to", "full", "root", "access", "by", "rewriting", "a", "trusted", "file", "such", "as", "/", "etc", "/", "shadow", "or", "even", "/", "etc", "/", "sudoers", ".", "\u201d", "The", "Linux", "flaw", "affects", "all", "Sudo", "versions", "from", "1.8.6", "p7", "through", "1.8.20", ",", "the", "Sudo", "1.8.20", "p1", "fixes", "it", ",", "the", "issue", "was", "rated", "with", "a", "CVSS3", "Base", "Score", "of", "7.8", "."], "Event 1": {"trigger": {"start": 5, "end": 7, "text": ["have", "discovered"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 0, "end": 2, "text": ["Security", "researchers"]}, {"start": 3, "end": 5, "text": ["Qualys", "Security"]}, {"start": 8, "end": 10, "text": ["Linux", "flaw"]}], "Causal": [{"start": 0, "end": 2, "text": ["Security", "researchers"]}, {"start": 3, "end": 5, "text": ["Qualys", "Security"]}, {"start": 8, "end": 10, "text": ["Linux", "flaw"]}], "Effect": []}, "Event 2": {"trigger": {"start": 12, "end": 14, "text": ["be", "exploited"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 15, "end": 18, "text": ["gain", "root", "privileges"]}, {"start": 26, "end": 30, "text": ["SELinux", "-", "enabled", "systems"]}, {"start": 19, "end": 25, "text": ["overwrite", "any", "file", "on", "the", "filesystem"]}], "Causal": [{"start": 15, "end": 18, "text": ["gain", "root", "privileges"]}, {"start": 19, "end": 25, "text": ["overwrite", "any", "file", "on", "the", "filesystem"]}], "Effect": []}, "Event 3": {"trigger": {"start": 41, "end": 43, "text": ["resides", "in"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 44, "end": 45, "text": ["Sudo"]}, {"start": 46, "end": 49, "text": ["get_process_ttyname", "(", ")"]}, {"start": 50, "end": 51, "text": ["Linux"]}], "Causal": [], "Effect": []}, "Event 4": {"trigger": {"start": 36, "end": 38, "text": ["tracked", "as"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 33, "end": 35, "text": ["severity", "flaw"]}, {"start": 38, "end": 40, "text": ["CVE", "-2017-1000367"]}], "Causal": [{"start": 33, "end": 35, "text": ["severity", "flaw"]}, {"start": 38, "end": 40, "text": ["CVE", "-2017-1000367"]}], "Effect": []}, "Event 5": {"trigger": {"start": 75, "end": 77, "text": ["be", "exploited"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 71, "end": 74, "text": ["The", "Linux", "flaw"]}, {"start": 82, "end": 86, "text": ["privileges", "to", "execute", "commands"]}, {"start": 90, "end": 98, "text": ["allow", "attackers", "to", "escalate", "their", "privileges", "to", "root"]}, {"start": 87, "end": 88, "text": ["Sudo"]}], "Causal": [{"start": 71, "end": 74, "text": ["The", "Linux", "flaw"]}, {"start": 82, "end": 86, "text": ["privileges", "to", "execute", "commands"]}, {"start": 90, "end": 98, "text": ["allow", "attackers", "to", "escalate", "their", "privileges", "to", "root"]}], "Effect": []}, "Event 6": {"trigger": {"start": 191, "end": 192, "text": ["discovered"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 190, "end": 191, "text": ["We"]}, {"start": 192, "end": 194, "text": ["a", "vulnerability"]}, {"start": 195, "end": 196, "text": ["Sudo"]}, {"start": 201, "end": 202, "text": ["Linux"]}, {"start": 197, "end": 200, "text": ["get_process_ttyname", "(", ")"]}], "Causal": [{"start": 190, "end": 191, "text": ["We"]}, {"start": 192, "end": 194, "text": ["a", "vulnerability"]}], "Effect": []}, "Event 7": {"trigger": {"start": 697, "end": 698, "text": ["affects"]}, "event_type": "DiscoverVulnerability", "argument": [{"start": 705, "end": 706, "text": ["1.8.20"]}, {"start": 700, "end": 704, "text": ["versions", "from", "1.8.6", "p7"]}, {"start": 699, "end": 700, "text": ["Sudo"]}, {"start": 695, "end": 697, "text": ["Linux", "flaw"]}], "Causal": [{"start": 695, "end": 697, "text": ["Linux", "flaw"]}], "Effect": []}, "Event 8": {"trigger": {"start": 711, "end": 712, "text": ["fixes"]}, "event_type": "PatchVulnerability", "argument": [{"start": 709, "end": 711, "text": ["1.8.20", "p1"]}, {"start": 708, "end": 709, "text": ["Sudo"]}, {"start": 714, "end": 716, "text": ["the", "issue"]}], "Causal": [{"start": 714, "end": 716, "text": ["the", "issue"]}], "Effect": []}}