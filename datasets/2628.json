{"tokens": ["Security", "researchers", "at", "Qualys", "Security", "have", "discovered", "a", "Linux", "flaw", "that", "could", "be", "exploited", "to", "gain", "root", "privileges", "and", "overwrite", "any", "file", "on", "the", "filesystem", "on", "SELinux", "-", "enabled", "systems", ".", "The", "high", "severity", "flaw", ",", "tracked", "as", "CVE", "-2017-1000367", ",", "resides", "in", "the", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", "and", "is", "related", "to", "the", "way", "Sudo", "parses", "tty", "information", "from", "the", "process", "status", "file", "in", "the", "proc", "filesystem", ".", "The", "Linux", "flaw", "could", "be", "exploited", "by", "a", "local", "user", "with", "privileges", "to", "execute", "commands", "via", "Sudo", "and", "could", "allow", "attackers", "to", "escalate", "their", "privileges", "to", "root", ".", "The", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "These", "fields", "are", "space", "-", "separated", ",", "the", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", ".", "Sudoer", "users", "on", "SELinux", "-", "enabled", "systems", "could", "escalate", "their", "privileges", "to", "overwrite", "any", "file", "on", "the", "filesystem", "with", "their", "command", "\u2019s", "output", ",", "including", "root", "-", "owned", "files", ".", "\u201c", "We", "discovered", "a", "vulnerability", "in", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", ":", "this", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "Unfortunately", ",", "these", "fields", "are", "space", "-", "separated", "and", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", "(", "CVE", "-2017-1000367", ")", ".", "\u201d", "reads", "the", "security", "advisory", ".", "\u201c", "On", "an", "SELinux", "-", "enabled", "system", ",", "if", "a", "user", "is", "Sudoer", "for", "a", "command", "that", "does", "not", "grant", "him", "full", "root", "privileges", ",", "he", "can", "overwrite", "any", "file", "on", "the", "filesystem", "(", "including", "root", "-", "owned", "files", ")", "with", "his", "command", "\u2019s", "output", ",", "because", "relabel_tty", "(", ")", "(", "in", "src/selinux.c", ")", "calls", "open", "(", "O_RDWR", "|", "O_NONBLOCK", ")", "on", "his", "tty", "and", "dup2", "(", ")", "s", "it", "to", "the", "command", "\u2019s", "stdin", ",", "stdout", ",", "and", "stderr", ".", "This", "allows", "any", "Sudoer", "user", "to", "obtain", "full", "root", "privileges", ".", "\u201d", "To", "exploit", "the", "issue", ",", "a", "Sudo", "user", "would", "have", "to", "choose", "a", "device", "number", "that", "does", "n\u2019t", "exist", "under", "\u201c", "/", "dev", "\u201d", ".", "If", "the", "terminal", "is", "n\u2019t", "present", "under", "the", "/", "dev", "/", "pts", "directory", "when", "the", "Sudo", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ",", "the", "user", "could", "allocate", "a", "pseudo-terminal", "between", "the", "two", "searchers", "and", "create", "a", "\u201c", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ",", "\u201d", "\u201c", "Exploiting", "the", "bug", "requires", "that", "the", "user", "already", "have", "sudo", "privileges", ".", "SELinux", "must", "also", "be", "enabled", "on", "the", "system", "and", "sudo", "must", "have", "been", "built", "with", "SELinux", "support", ".", "To", "exploit", "the", "bug", ",", "the", "user", "can", "choose", "a", "device", "number", "that", "does", "not", "currently", "exist", "under", "/", "dev", ".", "If", "sudo", "does", "not", "find", "the", "terminal", "under", "the", "/", "dev", "/", "pts", "directory", ",", "it", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ".", "It", "is", "possible", "to", "allocate", "a", "pseudo-terminal", "after", "sudo", "has", "checked", "/", "dev", "/", "pts", "but", "before", "sudo", "performs", "its", "breadth", "-", "first", "search", "of", "/", "dev", ".", "The", "attacker", "may", "then", "create", "a", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ".", "\u201d", "read", "a", "Sudo", "alert", ".", "\u201c", "This", "file", "will", "be", "used", "as", "the", "command", "\u2019s", "standard", "input", ",", "output", "and", "error", "when", "an", "SELinux", "role", "is", "specified", "on", "the", "sudo", "command", "line", ".", "If", "the", "symbolic", "link", "under", "/", "dev", "/", "shm", "is", "replaced", "with", "a", "link", "to", "an", "another", "file", "before", "it", "is", "opened", "by", "sudo", ",", "it", "is", "possible", "to", "overwrite", "an", "arbitrary", "file", "by", "writing", "to", "the", "standard", "output", "or", "standard", "error", ".", "This", "can", "be", "escalated", "to", "full", "root", "access", "by", "rewriting", "a", "trusted", "file", "such", "as", "/", "etc", "/", "shadow", "or", "even", "/", "etc", "/", "sudoers", ".", "\u201d", "The", "Linux", "flaw", "affects", "all", "Sudo", "versions", "from", "1.8.6", "p7", "through", "1.8.20", ",", "the", "Sudo", "1.8.20", "p1", "fixes", "it", ",", "the", "issue", "was", "rated", "with", "a", "CVSS3", "Base", "Score", "of", "7.8", "."], "entities": [{"type": "DiscoverVulnerability", "start": 5, "end": 7, "text": ["have", "discovered"], "role": "trigger"}, {"type": "Person", "start": 0, "end": 2, "text": ["Security", "researchers"], "role": "Discoverer"}, {"type": "Organization", "start": 3, "end": 5, "text": ["Qualys", "Security"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 8, "end": 10, "text": ["Linux", "flaw"], "role": "Vulnerability"}, {"type": "DiscoverVulnerability", "start": 12, "end": 14, "text": ["be", "exploited"], "role": "trigger"}, {"type": "Capabilities", "start": 15, "end": 18, "text": ["gain", "root", "privileges"], "role": "Capabilities"}, {"type": "System", "start": 26, "end": 30, "text": ["SELinux", "-", "enabled", "systems"], "role": "Vulnerable_System"}, {"type": "Capabilities", "start": 19, "end": 25, "text": ["overwrite", "any", "file", "on", "the", "filesystem"], "role": "Capabilities"}, {"type": "DiscoverVulnerability", "start": 41, "end": 43, "text": ["resides", "in"], "role": "trigger"}, {"type": "Software", "start": 44, "end": 45, "text": ["Sudo"], "role": "Vulnerable_System"}, {"type": "Software", "start": 46, "end": 49, "text": ["get_process_ttyname", "(", ")"], "role": "Vulnerable_System"}, {"type": "System", "start": 50, "end": 51, "text": ["Linux"], "role": "Supported_Platform"}, {"type": "DiscoverVulnerability", "start": 36, "end": 38, "text": ["tracked", "as"], "role": "trigger"}, {"type": "Vulnerability", "start": 33, "end": 35, "text": ["severity", "flaw"], "role": "Vulnerability"}, {"type": "CVE", "start": 38, "end": 40, "text": ["CVE", "-2017-1000367"], "role": "CVE"}, {"type": "DiscoverVulnerability", "start": 75, "end": 77, "text": ["be", "exploited"], "role": "trigger"}, {"type": "Vulnerability", "start": 71, "end": 74, "text": ["The", "Linux", "flaw"], "role": "Vulnerability"}, {"type": "Capabilities", "start": 82, "end": 86, "text": ["privileges", "to", "execute", "commands"], "role": "Capabilities"}, {"type": "Capabilities", "start": 90, "end": 98, "text": ["allow", "attackers", "to", "escalate", "their", "privileges", "to", "root"], "role": "Capabilities"}, {"type": "Software", "start": 87, "end": 88, "text": ["Sudo"], "role": "Vulnerable_System"}, {"type": "DiscoverVulnerability", "start": 191, "end": 192, "text": ["discovered"], "role": "trigger"}, {"type": "Person", "start": 190, "end": 191, "text": ["We"], "role": "Discoverer"}, {"type": "Vulnerability", "start": 192, "end": 194, "text": ["a", "vulnerability"], "role": "Vulnerability"}, {"type": "Software", "start": 195, "end": 196, "text": ["Sudo"], "role": "Vulnerable_System"}, {"type": "System", "start": 201, "end": 202, "text": ["Linux"], "role": "Vulnerable_System"}, {"type": "Software", "start": 197, "end": 200, "text": ["get_process_ttyname", "(", ")"], "role": "Vulnerable_System"}, {"type": "DiscoverVulnerability", "start": 697, "end": 698, "text": ["affects"], "role": "trigger"}, {"type": "Version", "start": 705, "end": 706, "text": ["1.8.20"], "role": "Vulnerable_System_Version"}, {"type": "Version", "start": 700, "end": 704, "text": ["versions", "from", "1.8.6", "p7"], "role": "Vulnerable_System_Version"}, {"type": "Software", "start": 699, "end": 700, "text": ["Sudo"], "role": "Vulnerable_System"}, {"type": "Vulnerability", "start": 695, "end": 697, "text": ["Linux", "flaw"], "role": "Vulnerability"}, {"type": "PatchVulnerability", "start": 711, "end": 712, "text": ["fixes"], "role": "trigger"}, {"type": "Version", "start": 709, "end": 711, "text": ["1.8.20", "p1"], "role": "Patch-Number"}, {"type": "Software", "start": 708, "end": 709, "text": ["Sudo"], "role": "Vulnerable_System"}, {"type": "Vulnerability", "start": 714, "end": 716, "text": ["the", "issue"], "role": "Vulnerability"}], "relations": [{"type": "Causal", "head": 1, "tail": 0}, {"type": "Causal", "head": 2, "tail": 0}, {"type": "Causal", "head": 3, "tail": 0}, {"type": "Causal", "head": 5, "tail": 4}, {"type": "Causal", "head": 7, "tail": 4}, {"type": "Causal", "head": 13, "tail": 12}, {"type": "Causal", "head": 14, "tail": 12}, {"type": "Causal", "head": 16, "tail": 15}, {"type": "Causal", "head": 17, "tail": 15}, {"type": "Causal", "head": 18, "tail": 15}, {"type": "Causal", "head": 21, "tail": 20}, {"type": "Causal", "head": 22, "tail": 20}, {"type": "Causal", "head": 30, "tail": 26}, {"type": "Causal", "head": 34, "tail": 31}], "POS": ["NN", "NNS", "IN", "NNP", "NNP", "VBP", "VBN", "DT", "NNP", "NN", "WDT", "MD", "VB", "VBN", "TO", "VB", "NN", "NNS", "CC", "JJ", "DT", "NN", "IN", "DT", "NN", "IN", "NNP", ":", "VBD", "NNS", ".", "DT", "JJ", "NN", "NN", ",", "VBD", "IN", "NNP", "NNP", ",", "VBZ", "IN", "DT", "NNP", "NNP", "NN", "(", ")", "IN", "NNP", "CC", "VBZ", "VBN", "TO", "DT", "NN", "NNP", "VBZ", "JJ", "NN", "IN", "DT", "NN", "NN", "NN", "IN", "DT", "NN", "NN", ".", "DT", "NNP", "NN", "MD", "VB", "VBN", "IN", "DT", "JJ", "NN", "IN", "NNS", "TO", "VB", "NNS", "IN", "NNP", "CC", "MD", "VB", "NNS", "TO", "VB", "PRP$", "NNS", "TO", "VB", ".", "DT", "NNP", "NNP", "NN", "(", ")", "NN", "VBZ", "JJ", "NNP", "NN", "NNP", "NNP", "JJ", "NNP", "NNP", "NN", "NNP", "(", "NN", "NN", ")", "CC", "VBZ", "DT", "NN", "NN", "IN", "DT", "NN", "IN", "NN", "CD", "(", "NN", ")", ".", "DT", "NNS", "VBP", "NN", ":", "VBN", ",", "DT", "NN", "CD", "(", "NN", ",", "DT", "NN", "IN", "DT", "NN", ")", "MD", "VB", "NNS", ".", "NNP", "NNS", "IN", "NNP", ":", "VBD", "NNS", "MD", "VB", "PRP$", "NNS", "TO", "VB", "DT", "NN", "IN", "DT", "NN", "IN", "PRP$", "NN", "NNP", "NN", ",", "VBG", "SYM", ":", "VBN", "NNS", ".", "NN", "PRP", "VBD", "DT", "NN", "IN", "NNP", "NNP", "NN", "(", ")", "IN", "NN", ":", "DT", "NN", "VBZ", "JJ", "NNP", "NN", "NNP", "NNP", "JJ", "NNP", "NNP", "NN", "NNP", "(", "NN", "NN", ")", "CC", "VBZ", "DT", "NN", "NN", "IN", "DT", "NN", "IN", "NN", "CD", "(", "NN", ")", ".", "RB", ",", "DT", "NNS", "VBP", "NN", ":", "VBN", "CC", "NN", "CD", "(", "NN", ",", "DT", "NN", "IN", "DT", "NN", ")", "MD", "VB", "NNS", "(", "NNP", "NNP", ")", ".", "CC", "VBZ", "DT", "NN", "NN", ".", "NN", "IN", "DT", "NNP", ":", "JJ", "NN", ",", "IN", "DT", "NN", "VBZ", "NNP", "IN", "DT", "NN", "WDT", "VBZ", "RB", "VB", "PRP", "JJ", "NN", "NNS", ",", "PRP", "MD", "VB", "DT", "NN", "IN", "DT", "NN", "(", "VBG", "NN", ":", "VBN", "NNS", ")", "IN", "PRP$", "NN", "NNP", "NN", ",", "IN", "NN", "(", ")", "(", "IN", "NN", ")", "VBZ", "JJ", "(", "NNP", "NNP", "NNP", ")", "IN", "PRP$", "NN", "CC", "NN", "(", ")", "VBZ", "PRP", "TO", "DT", "NN", "NNP", "NN", ",", "NN", ",", "CC", "NN", ".", "DT", "VBZ", "DT", "NNP", "NN", "TO", "VB", "JJ", "NN", "NNS", ".", "NN", "TO", "VB", "DT", "NN", ",", "DT", "NNP", "NN", "MD", "VB", "TO", "VB", "DT", "NN", "NN", "WDT", "VBZ", "JJ", "VB", "IN", "NNP", "NNP", "NN", "NNP", ".", "IN", "DT", "NN", "VBZ", "JJ", "JJ", "IN", "DT", "NNP", "NN", "NN", "NNS", "NN", "WRB", "DT", "NNP", "VBZ", "DT", "NN", ":", "JJ", "NN", "IN", "NNP", "NN", ",", "DT", "NN", "MD", "VB", "DT", "JJ", "IN", "DT", "CD", "NNS", "CC", "VB", "DT", "JJ", "JJ", "NN", "TO", "DT", "RB", ":", "VBN", "NN", "IN", "DT", "NN", ":", "JJ", "NN", "IN", "NNP", "NN", ",", "JJ", "IN", "JJ", "NN", "NNP", "NN", ",", "NNP", "NNP", "VBG", "DT", "NN", "VBZ", "IN", "DT", "NN", "RB", "VBP", "VBN", "NNS", ".", "NNP", "MD", "RB", "VB", "VBN", "IN", "DT", "NN", "CC", "NN", "MD", "VB", "VBN", "VBN", "IN", "NNP", "NN", ".", "TO", "VB", "DT", "NN", ",", "DT", "NN", "MD", "VB", "DT", "NN", "NN", "WDT", "VBZ", "RB", "RB", "VBP", "IN", "NNP", "NN", ".", "IN", "NN", "VBZ", "RB", "VB", "DT", "NN", "IN", "DT", "NNP", "NN", "NN", "NNS", "NN", ",", "PRP", "VBZ", "DT", "NN", ":", "JJ", "NN", "IN", "NNP", "NN", ".", "PRP", "VBZ", "JJ", "TO", "VB", "DT", "JJ", "IN", "NN", "VBZ", "VBN", "NNP", "NN", "NN", "NNS", "CC", "IN", "JJ", "NNS", "PRP$", "NN", ":", "JJ", "NN", "IN", "NNP", "NN", ".", "DT", "NN", "MD", "RB", "VB", "DT", "JJ", "NN", "TO", "DT", "RB", ":", "VBN", "NN", "IN", "DT", "NN", ":", "JJ", "NN", "IN", "NNP", "NN", ",", "JJ", "IN", "JJ", "NN", "NNP", "NN", ".", "JJ", "VBD", "DT", "NNP", "NN", ".", "VB", "DT", "NN", "MD", "VB", "VBN", "IN", "DT", "NN", "NNP", "NN", "NN", ",", "NN", "CC", "NN", "WRB", "DT", "NNP", "NN", "VBZ", "VBN", "IN", "DT", "NN", "NN", "NN", ".", "IN", "DT", "JJ", "NN", "IN", "NNP", "NN", "NNP", "NN", "VBZ", "VBN", "IN", "DT", "NN", "TO", "DT", "DT", "NN", "IN", "PRP", "VBZ", "VBN", "IN", "NN", ",", "PRP", "VBZ", "JJ", "TO", "VB", "DT", "JJ", "NN", "IN", "VBG", "TO", "DT", "JJ", "NN", "CC", "JJ", "NN", ".", "DT", "MD", "VB", "VBN", "TO", "JJ", "NN", "NN", "IN", "VBG", "DT", "VBN", "NN", "JJ", "IN", "JJ", "FW", "JJ", "NN", "CC", "RB", "JJ", "FW", "JJ", "NNS", ".", "VB", "DT", "NNP", "NN", "VBZ", "DT", "NNP", "NNS", "IN", "CD", "NNS", "IN", "CD", ",", "DT", "NNP", "CD", "NN", "NNS", "PRP", ",", "DT", "NN", "VBD", "VBN", "IN", "DT", "NNP", "NNP", "NNP", "IN", "CD", "."]}