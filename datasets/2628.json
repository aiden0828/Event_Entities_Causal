{"tokens": ["Security", "researchers", "at", "Qualys", "Security", "have", "discovered", "a", "Linux", "flaw", "that", "could", "be", "exploited", "to", "gain", "root", "privileges", "and", "overwrite", "any", "file", "on", "the", "filesystem", "on", "SELinux", "-", "enabled", "systems", ".", "The", "high", "severity", "flaw", ",", "tracked", "as", "CVE", "-2017-1000367", ",", "resides", "in", "the", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", "and", "is", "related", "to", "the", "way", "Sudo", "parses", "tty", "information", "from", "the", "process", "status", "file", "in", "the", "proc", "filesystem", ".", "The", "Linux", "flaw", "could", "be", "exploited", "by", "a", "local", "user", "with", "privileges", "to", "execute", "commands", "via", "Sudo", "and", "could", "allow", "attackers", "to", "escalate", "their", "privileges", "to", "root", ".", "The", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "These", "fields", "are", "space", "-", "separated", ",", "the", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", ".", "Sudoer", "users", "on", "SELinux", "-", "enabled", "systems", "could", "escalate", "their", "privileges", "to", "overwrite", "any", "file", "on", "the", "filesystem", "with", "their", "command", "\u2019s", "output", ",", "including", "root", "-", "owned", "files", ".", "\u201c", "We", "discovered", "a", "vulnerability", "in", "Sudo", "\u2019s", "get_process_ttyname", "(", ")", "for", "Linux", ":", "this", "function", "opens", "\u201c", "/", "proc", "/", "[", "pid", "]", "/", "stat", "\u201d", "(", "man", "proc", ")", "and", "reads", "the", "device", "number", "of", "the", "tty", "from", "field", "7", "(", "tty_nr", ")", ".", "Unfortunately", ",", "these", "fields", "are", "space", "-", "separated", "and", "field", "2", "(", "comm", ",", "the", "filename", "of", "the", "command", ")", "can", "contain", "spaces", "(", "CVE", "-2017-1000367", ")", ".", "\u201d", "reads", "the", "security", "advisory", ".", "\u201c", "On", "an", "SELinux", "-", "enabled", "system", ",", "if", "a", "user", "is", "Sudoer", "for", "a", "command", "that", "does", "not", "grant", "him", "full", "root", "privileges", ",", "he", "can", "overwrite", "any", "file", "on", "the", "filesystem", "(", "including", "root", "-", "owned", "files", ")", "with", "his", "command", "\u2019s", "output", ",", "because", "relabel_tty", "(", ")", "(", "in", "src/selinux.c", ")", "calls", "open", "(", "O_RDWR", "|", "O_NONBLOCK", ")", "on", "his", "tty", "and", "dup2", "(", ")", "s", "it", "to", "the", "command", "\u2019s", "stdin", ",", "stdout", ",", "and", "stderr", ".", "This", "allows", "any", "Sudoer", "user", "to", "obtain", "full", "root", "privileges", ".", "\u201d", "To", "exploit", "the", "issue", ",", "a", "Sudo", "user", "would", "have", "to", "choose", "a", "device", "number", "that", "does", "n\u2019t", "exist", "under", "\u201c", "/", "dev", "\u201d", ".", "If", "the", "terminal", "is", "n\u2019t", "present", "under", "the", "/", "dev", "/", "pts", "directory", "when", "the", "Sudo", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ",", "the", "user", "could", "allocate", "a", "pseudo-terminal", "between", "the", "two", "searchers", "and", "create", "a", "\u201c", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ",", "\u201d", "\u201c", "Exploiting", "the", "bug", "requires", "that", "the", "user", "already", "have", "sudo", "privileges", ".", "SELinux", "must", "also", "be", "enabled", "on", "the", "system", "and", "sudo", "must", "have", "been", "built", "with", "SELinux", "support", ".", "To", "exploit", "the", "bug", ",", "the", "user", "can", "choose", "a", "device", "number", "that", "does", "not", "currently", "exist", "under", "/", "dev", ".", "If", "sudo", "does", "not", "find", "the", "terminal", "under", "the", "/", "dev", "/", "pts", "directory", ",", "it", "performs", "a", "breadth", "-", "first", "search", "of", "/", "dev", ".", "It", "is", "possible", "to", "allocate", "a", "pseudo-terminal", "after", "sudo", "has", "checked", "/", "dev", "/", "pts", "but", "before", "sudo", "performs", "its", "breadth", "-", "first", "search", "of", "/", "dev", ".", "The", "attacker", "may", "then", "create", "a", "symbolic", "link", "to", "the", "newly", "-", "created", "device", "in", "a", "world", "-", "writable", "directory", "under", "/", "dev", ",", "such", "as", "/", "dev", "/", "shm", ".", "\u201d", "read", "a", "Sudo", "alert", ".", "\u201c", "This", "file", "will", "be", "used", "as", "the", "command", "\u2019s", "standard", "input", ",", "output", "and", "error", "when", "an", "SELinux", "role", "is", "specified", "on", "the", "sudo", "command", "line", ".", "If", "the", "symbolic", "link", "under", "/", "dev", "/", "shm", "is", "replaced", "with", "a", "link", "to", "an", "another", "file", "before", "it", "is", "opened", "by", "sudo", ",", "it", "is", "possible", "to", "overwrite", "an", "arbitrary", "file", "by", "writing", "to", "the", "standard", "output", "or", "standard", "error", ".", "This", "can", "be", "escalated", "to", "full", "root", "access", "by", "rewriting", "a", "trusted", "file", "such", "as", "/", "etc", "/", "shadow", "or", "even", "/", "etc", "/", "sudoers", ".", "\u201d", "The", "Linux", "flaw", "affects", "all", "Sudo", "versions", "from", "1.8.6", "p7", "through", "1.8.20", ",", "the", "Sudo", "1.8.20", "p1", "fixes", "it", ",", "the", "issue", "was", "rated", "with", "a", "CVSS3", "Base", "Score", "of", "7.8", "."], "trigger": [{"start": 5, "end": 6, "text": ["have", "discovered"], "event": "DiscoverVulnerability"}, {"start": 12, "end": 13, "text": ["be", "exploited"], "event": "DiscoverVulnerability"}, {"start": 41, "end": 42, "text": ["resides", "in"], "event": "DiscoverVulnerability"}, {"start": 36, "end": 37, "text": ["tracked", "as"], "event": "DiscoverVulnerability"}, {"start": 75, "end": 76, "text": ["be", "exploited"], "event": "DiscoverVulnerability"}, {"start": 191, "end": 191, "text": ["discovered"], "event": "DiscoverVulnerability"}, {"start": 697, "end": 697, "text": ["affects"], "event": "DiscoverVulnerability"}, {"start": 711, "end": 711, "text": ["fixes"], "event": "PatchVulnerability"}], "Entities": [[{"start": 0, "end": 1, "text": ["Security", "researchers"], "type": "Person"}, {"start": 3, "end": 4, "text": ["Qualys", "Security"], "type": "Organization"}, {"start": 8, "end": 9, "text": ["Linux", "flaw"], "type": "Vulnerability"}], [{"start": 15, "end": 17, "text": ["gain", "root", "privileges"], "type": "Capabilities"}, {"start": 26, "end": 29, "text": ["SELinux", "-", "enabled", "systems"], "type": "System"}, {"start": 19, "end": 24, "text": ["overwrite", "any", "file", "on", "the", "filesystem"], "type": "Capabilities"}], [{"start": 44, "end": 44, "text": ["Sudo"], "type": "Software"}, {"start": 46, "end": 48, "text": ["get_process_ttyname", "(", ")"], "type": "Software"}, {"start": 50, "end": 50, "text": ["Linux"], "type": "System"}], [{"start": 33, "end": 34, "text": ["severity", "flaw"], "type": "Vulnerability"}, {"start": 38, "end": 39, "text": ["CVE", "-2017-1000367"], "type": "CVE"}], [{"start": 71, "end": 73, "text": ["The", "Linux", "flaw"], "type": "Vulnerability"}, {"start": 82, "end": 85, "text": ["privileges", "to", "execute", "commands"], "type": "Capabilities"}, {"start": 90, "end": 97, "text": ["allow", "attackers", "to", "escalate", "their", "privileges", "to", "root"], "type": "Capabilities"}, {"start": 87, "end": 87, "text": ["Sudo"], "type": "Software"}], [{"start": 190, "end": 190, "text": ["We"], "type": "Person"}, {"start": 192, "end": 193, "text": ["a", "vulnerability"], "type": "Vulnerability"}, {"start": 195, "end": 195, "text": ["Sudo"], "type": "Software"}, {"start": 201, "end": 201, "text": ["Linux"], "type": "System"}, {"start": 197, "end": 199, "text": ["get_process_ttyname", "(", ")"], "type": "Software"}], [{"start": 705, "end": 705, "text": ["1.8.20"], "type": "Version"}, {"start": 700, "end": 703, "text": ["versions", "from", "1.8.6", "p7"], "type": "Version"}, {"start": 699, "end": 699, "text": ["Sudo"], "type": "Software"}, {"start": 695, "end": 696, "text": ["Linux", "flaw"], "type": "Vulnerability"}], [{"start": 709, "end": 710, "text": ["1.8.20", "p1"], "type": "Version"}, {"start": 708, "end": 708, "text": ["Sudo"], "type": "Software"}, {"start": 714, "end": 715, "text": ["the", "issue"], "type": "Vulnerability"}]], "Causal": [[{"start": 0, "end": 1, "text": ["Security", "researchers"], "type": "Person"}, {"start": 3, "end": 4, "text": ["Qualys", "Security"], "type": "Organization"}, {"start": 8, "end": 9, "text": ["Linux", "flaw"], "type": "Vulnerability"}], [], [], [{"start": 38, "end": 39, "text": ["CVE", "-2017-1000367"], "type": "CVE"}], [{"start": 71, "end": 73, "text": ["The", "Linux", "flaw"], "type": "Vulnerability"}, {"start": 87, "end": 87, "text": ["Sudo"], "type": "Software"}], [{"start": 190, "end": 190, "text": ["We"], "type": "Person"}, {"start": 192, "end": 193, "text": ["a", "vulnerability"], "type": "Vulnerability"}], [{"start": 695, "end": 696, "text": ["Linux", "flaw"], "type": "Vulnerability"}], [{"start": 714, "end": 715, "text": ["the", "issue"], "type": "Vulnerability"}]], "Effect": [[], [{"start": 15, "end": 17, "text": ["gain", "root", "privileges"], "type": "Capabilities"}, {"start": 26, "end": 29, "text": ["SELinux", "-", "enabled", "systems"], "type": "System"}, {"start": 19, "end": 24, "text": ["overwrite", "any", "file", "on", "the", "filesystem"], "type": "Capabilities"}], [{"start": 44, "end": 44, "text": ["Sudo"], "type": "Software"}, {"start": 46, "end": 48, "text": ["get_process_ttyname", "(", ")"], "type": "Software"}, {"start": 50, "end": 50, "text": ["Linux"], "type": "System"}], [], [{"start": 82, "end": 85, "text": ["privileges", "to", "execute", "commands"], "type": "Capabilities"}, {"start": 90, "end": 97, "text": ["allow", "attackers", "to", "escalate", "their", "privileges", "to", "root"], "type": "Capabilities"}], [{"start": 195, "end": 195, "text": ["Sudo"], "type": "Software"}, {"start": 201, "end": 201, "text": ["Linux"], "type": "System"}, {"start": 197, "end": 199, "text": ["get_process_ttyname", "(", ")"], "type": "Software"}], [{"start": 705, "end": 705, "text": ["1.8.20"], "type": "Version"}, {"start": 700, "end": 703, "text": ["versions", "from", "1.8.6", "p7"], "type": "Version"}, {"start": 699, "end": 699, "text": ["Sudo"], "type": "Software"}], [{"start": 709, "end": 710, "text": ["1.8.20", "p1"], "type": "Version"}, {"start": 708, "end": 708, "text": ["Sudo"], "type": "Software"}]]}